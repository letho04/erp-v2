import{r as B,a as En,g as pr,c as x,j as Lt}from"./index-DoA7Gsr8.js";var Ce={},Xt={},xn={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.useColumnWidths=e.getColumnWidths=void 0;const t=B,n=(o,i)=>{const l=i.map(({basis:p,minWidth:s,maxWidth:u})=>({basis:p,minWidth:s,maxWidth:u,size:p,violation:0,frozen:!1,factor:0}));let c=l.reduce((p,s)=>p-s.size,o);c>0?i.forEach(({grow:p},s)=>{l[s].factor=p}):c<0&&i.forEach(({shrink:p},s)=>{l[s].factor=p});for(const p of l)p.factor===0&&(p.frozen=!0);for(;l.some(({frozen:p})=>!p);){const p=l.reduce((u,b)=>u+(b.frozen?0:b.factor),0);let s=0;for(const u of l)u.frozen||(u.size+=c*u.factor/p,u.size<u.minWidth?u.violation=u.minWidth-u.size:u.maxWidth!==void 0&&u.size>u.maxWidth?u.violation=u.maxWidth-u.size:u.violation=0,u.size+=u.violation,s+=u.violation);if(s>0)for(const u of l)u.violation>0&&(u.frozen=!0);else if(s<0)for(const u of l)u.violation<0&&(u.frozen=!0);else break;c=l.reduce((u,b)=>u-b.size,o)}return l.map(({size:p})=>p)};e.getColumnWidths=n;const r=(o,i)=>{const l=o.map(({basis:c,minWidth:p,maxWidth:s,grow:u,shrink:b})=>[c,p,s,u,b].join(",")).join("|");return(0,t.useMemo)(()=>{if(i===void 0)return{fullWidth:!1,columnWidths:void 0,columnRights:void 0,totalWidth:void 0};const c=(0,e.getColumnWidths)(i,o);let p=0;const s=c.map((u,b)=>(p+=u,b===c.length-1?1/0:p));return{fullWidth:Math.abs(i-p)<.1,columnWidths:c,columnRights:s,totalWidth:p}},[i,l])};e.useColumnWidths=r})(xn);var Ut=function(e,t){return Ut=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},Ut(e,t)};function Cn(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Ut(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var Xe=function(){return Xe=Object.assign||function(t){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Xe.apply(this,arguments)};function Sn(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n}var it=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gr(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Yt=gr,br=typeof it=="object"&&it&&it.Object===Object&&it,_r=br,yr=_r,wr=typeof self=="object"&&self&&self.Object===Object&&self,Or=yr||wr||Function("return this")(),Dn=Or,Er=Dn,xr=function(){return Er.Date.now()},Cr=xr,Sr=/\s/;function Dr(e){for(var t=e.length;t--&&Sr.test(e.charAt(t)););return t}var Mr=Dr,Rr=Mr,jr=/^\s+/;function Ir(e){return e&&e.slice(0,Rr(e)+1).replace(jr,"")}var Tr=Ir,Pr=Dn,zr=Pr.Symbol,Mn=zr,mn=Mn,Rn=Object.prototype,Nr=Rn.hasOwnProperty,Ar=Rn.toString,et=mn?mn.toStringTag:void 0;function $r(e){var t=Nr.call(e,et),n=e[et];try{e[et]=void 0;var r=!0}catch{}var o=Ar.call(e);return r&&(t?e[et]=n:delete e[et]),o}var Fr=$r,Wr=Object.prototype,Br=Wr.toString;function Lr(e){return Br.call(e)}var Vr=Lr,hn=Mn,Gr=Fr,Kr=Vr,kr="[object Null]",Ur="[object Undefined]",vn=hn?hn.toStringTag:void 0;function qr(e){return e==null?e===void 0?Ur:kr:vn&&vn in Object(e)?Gr(e):Kr(e)}var Hr=qr;function Xr(e){return e!=null&&typeof e=="object"}var Yr=Xr,Qr=Hr,Jr=Yr,Zr="[object Symbol]";function eo(e){return typeof e=="symbol"||Jr(e)&&Qr(e)==Zr}var to=eo,no=Tr,pn=Yt,ro=to,gn=NaN,oo=/^[-+]0x[0-9a-f]+$/i,lo=/^0b[01]+$/i,io=/^0o[0-7]+$/i,so=parseInt;function ao(e){if(typeof e=="number")return e;if(ro(e))return gn;if(pn(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=pn(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=no(e);var n=lo.test(e);return n||io.test(e)?so(e.slice(2),n?2:8):oo.test(e)?gn:+e}var uo=ao,co=Yt,Vt=Cr,bn=uo,fo="Expected a function",mo=Math.max,ho=Math.min;function vo(e,t,n){var r,o,i,l,c,p,s=0,u=!1,b=!1,f=!0;if(typeof e!="function")throw new TypeError(fo);t=bn(t)||0,co(n)&&(u=!!n.leading,b="maxWait"in n,i=b?mo(bn(n.maxWait)||0,t):i,f="trailing"in n?!!n.trailing:f);function C(O){var P=r,z=o;return r=o=void 0,s=O,l=e.apply(z,P),l}function w(O){return s=O,c=setTimeout(T,t),u?C(O):l}function D(O){var P=O-p,z=O-s,Q=t-P;return b?ho(Q,i-z):Q}function _(O){var P=O-p,z=O-s;return p===void 0||P>=t||P<0||b&&z>=i}function T(){var O=Vt();if(_(O))return d(O);c=setTimeout(T,D(O))}function d(O){return c=void 0,f&&r?C(O):(r=o=void 0,l)}function v(){c!==void 0&&clearTimeout(c),s=0,r=p=o=c=void 0}function g(){return c===void 0?l:d(Vt())}function E(){var O=Vt(),P=_(O);if(r=arguments,o=this,p=O,P){if(c===void 0)return w(p);if(b)return clearTimeout(c),c=setTimeout(T,t),C(p)}return c===void 0&&(c=setTimeout(T,t)),l}return E.cancel=v,E.flush=g,E}var jn=vo,po=jn,go=Yt,bo="Expected a function";function _o(e,t,n){var r=!0,o=!0;if(typeof e!="function")throw new TypeError(bo);return go(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),po(e,t,{leading:r,maxWait:t,trailing:o})}var yo=_o,In=function(e,t,n,r){switch(t){case"debounce":return jn(e,n,r);case"throttle":return yo(e,n,r);default:return e}},qt=function(e){return typeof e=="function"},Ne=function(){return typeof window>"u"},_n=function(e){return e instanceof Element||e instanceof HTMLDocument},Tn=function(e,t,n,r){return function(o){var i=o.width,l=o.height;t(function(c){return c.width===i&&c.height===l||c.width===i&&!r||c.height===l&&!n?c:(e&&qt(e)&&e(i,l),{width:i,height:l})})}},Pn=function(e){Cn(t,e);function t(n){var r=e.call(this,n)||this;r.cancelHandler=function(){r.resizeHandler&&r.resizeHandler.cancel&&(r.resizeHandler.cancel(),r.resizeHandler=null)},r.attachObserver=function(){var s=r.props,u=s.targetRef,b=s.observerOptions;if(!Ne()){u&&u.current&&(r.targetRef.current=u.current);var f=r.getElement();f&&(r.observableElement&&r.observableElement===f||(r.observableElement=f,r.resizeObserver.observe(f,b)))}},r.getElement=function(){var s=r.props,u=s.querySelector,b=s.targetDomEl;if(Ne())return null;if(u)return document.querySelector(u);if(b&&_n(b))return b;if(r.targetRef&&_n(r.targetRef.current))return r.targetRef.current;var f=En.findDOMNode(r);if(!f)return null;var C=r.getRenderType();switch(C){case"renderProp":return f;case"childFunction":return f;case"child":return f;case"childArray":return f;default:return f.parentElement}},r.createResizeHandler=function(s){var u=r.props,b=u.handleWidth,f=b===void 0?!0:b,C=u.handleHeight,w=C===void 0?!0:C,D=u.onResize;if(!(!f&&!w)){var _=Tn(D,r.setState.bind(r),f,w);s.forEach(function(T){var d=T&&T.contentRect||{},v=d.width,g=d.height,E=!r.skipOnMount&&!Ne();E&&_({width:v,height:g}),r.skipOnMount=!1})}},r.getRenderType=function(){var s=r.props,u=s.render,b=s.children;return qt(u)?"renderProp":qt(b)?"childFunction":B.isValidElement(b)?"child":Array.isArray(b)?"childArray":"parent"};var o=n.skipOnMount,i=n.refreshMode,l=n.refreshRate,c=l===void 0?1e3:l,p=n.refreshOptions;return r.state={width:void 0,height:void 0},r.skipOnMount=o,r.targetRef=B.createRef(),r.observableElement=null,Ne()||(r.resizeHandler=In(r.createResizeHandler,i,c,p),r.resizeObserver=new window.ResizeObserver(r.resizeHandler)),r}return t.prototype.componentDidMount=function(){this.attachObserver()},t.prototype.componentDidUpdate=function(){this.attachObserver()},t.prototype.componentWillUnmount=function(){Ne()||(this.observableElement=null,this.resizeObserver.disconnect(),this.cancelHandler())},t.prototype.render=function(){var n=this.props,r=n.render,o=n.children,i=n.nodeType,l=i===void 0?"div":i,c=this.state,p=c.width,s=c.height,u={width:p,height:s,targetRef:this.targetRef},b=this.getRenderType(),f;switch(b){case"renderProp":return r&&r(u);case"childFunction":return f=o,f(u);case"child":if(f=o,f.type&&typeof f.type=="string"){u.targetRef;var C=Sn(u,["targetRef"]);return B.cloneElement(f,C)}return B.cloneElement(f,u);case"childArray":return f=o,f.map(function(w){return!!w&&B.cloneElement(w,u)});default:return B.createElement(l,null)}},t}(B.PureComponent);function wo(e,t){t===void 0&&(t={});var n=function(i){Cn(l,i);function l(){var c=i!==null&&i.apply(this,arguments)||this;return c.ref=B.createRef(),c}return l.prototype.render=function(){var c=this.props,p=c.forwardedRef,s=Sn(c,["forwardedRef"]),u=p??this.ref;return B.createElement(Pn,Xe({},t,{targetRef:u}),B.createElement(e,Xe({targetRef:u},s)))},l}(B.Component);function r(i,l){return B.createElement(n,Xe({},i,{forwardedRef:l}))}var o=e.displayName||e.name;return r.displayName="withResizeDetector(".concat(o,")"),B.forwardRef(r)}var Oo=Ne()?B.useEffect:B.useLayoutEffect;function Eo(e){e===void 0&&(e={});var t=e.skipOnMount,n=t===void 0?!1:t,r=e.refreshMode,o=e.refreshRate,i=o===void 0?1e3:o,l=e.refreshOptions,c=e.handleWidth,p=c===void 0?!0:c,s=e.handleHeight,u=s===void 0?!0:s,b=e.targetRef,f=e.observerOptions,C=e.onResize,w=B.useRef(n),D=B.useRef(null),_=b??D,T=B.useRef(),d=B.useState({width:void 0,height:void 0}),v=d[0],g=d[1];return Oo(function(){if(!Ne()){var E=Tn(C,g,p,u),O=function(z){!p&&!u||z.forEach(function(Q){var le=Q&&Q.contentRect||{},G=le.width,q=le.height,S=!w.current&&!Ne();S&&E({width:G,height:q}),w.current=!1})};T.current=In(O,r,i,l);var P=new window.ResizeObserver(T.current);return _.current&&P.observe(_.current,f),function(){P.disconnect();var z=T.current;z&&z.cancel&&z.cancel()}}},[r,i,l,p,u,C,f,_.current]),Xe({ref:_},v)}const xo=Object.freeze(Object.defineProperty({__proto__:null,default:Pn,useResizeDetector:Eo,withResizeDetector:wo},Symbol.toStringTag,{value:"Module"})),Co=pr(xo);var zn={};(function(e){var t=x&&x.__createBinding||(Object.create?function(w,D,_,T){T===void 0&&(T=_);var d=Object.getOwnPropertyDescriptor(D,_);(!d||("get"in d?!D.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return D[_]}}),Object.defineProperty(w,T,d)}:function(w,D,_,T){T===void 0&&(T=_),w[T]=D[_]}),n=x&&x.__setModuleDefault||(Object.create?function(w,D){Object.defineProperty(w,"default",{enumerable:!0,value:D})}:function(w,D){w.default=D}),r=x&&x.__importStar||function(w){if(w&&w.__esModule)return w;var D={};if(w!=null)for(var _ in w)_!=="default"&&Object.prototype.hasOwnProperty.call(w,_)&&t(D,w,_);return n(D,w),D};Object.defineProperty(e,"__esModule",{value:!0}),e.useColumns=e.parseFlexValue=void 0;const o=r(B),i=()=>o.default.createElement(o.default.Fragment,null),l=()=>!1,c=({rowData:w})=>w,p=()=>null,s=({rowIndex:w})=>o.default.createElement(o.default.Fragment,null,w+1),u=()=>!0,b=w=>w,f=w=>{if(typeof w=="number")return{basis:0,grow:w,shrink:1};if(w.match(/^ *\d+(\.\d*)? *$/))return{basis:0,grow:parseFloat(w.trim()),shrink:1};if(w.match(/^ *\d+(\.\d*)? *px *$/))return{basis:parseFloat(w.trim()),grow:1,shrink:1};if(w.match(/^ *\d+(\.\d*)? \d+(\.\d*)? *$/)){const[D,_]=w.trim().split(" ");return{basis:0,grow:parseFloat(D),shrink:parseFloat(_)}}if(w.match(/^ *\d+(\.\d*)? \d+(\.\d*)? *px *$/)){const[D,_]=w.trim().split(" ");return{basis:parseFloat(_),grow:parseFloat(D),shrink:1}}if(w.match(/^ *\d+(\.\d*)? \d+(\.\d*)? \d+(\.\d*)? *px *$/)){const[D,_,T]=w.trim().split(" ");return{basis:parseFloat(T),grow:parseFloat(D),shrink:parseFloat(_)}}return{basis:0,grow:1,shrink:1}};e.parseFlexValue=f;const C=(w,D,_)=>(0,o.useMemo)(()=>{var T,d,v,g,E,O,P,z,Q,le;const G=[D===!1?{basis:0,grow:0,shrink:0,minWidth:0,component:()=>o.default.createElement(o.default.Fragment,null),headerClassName:"dsg-hidden-cell",cellClassName:"dsg-hidden-cell",isCellEmpty:u}:Object.assign(Object.assign({},D),{basis:(T=D==null?void 0:D.basis)!==null&&T!==void 0?T:40,grow:(d=D==null?void 0:D.grow)!==null&&d!==void 0?d:0,shrink:(v=D==null?void 0:D.shrink)!==null&&v!==void 0?v:0,minWidth:(g=D==null?void 0:D.minWidth)!==null&&g!==void 0?g:0,title:(E=D==null?void 0:D.title)!==null&&E!==void 0?E:o.default.createElement("div",{className:"dsg-corner-indicator"}),component:(O=D==null?void 0:D.component)!==null&&O!==void 0?O:s,isCellEmpty:u}),...w];return _&&G.push(Object.assign(Object.assign({},_),{basis:(P=_==null?void 0:_.basis)!==null&&P!==void 0?P:40,grow:(z=_==null?void 0:_.grow)!==null&&z!==void 0?z:0,shrink:(Q=_==null?void 0:_.shrink)!==null&&Q!==void 0?Q:0,minWidth:(le=_.minWidth)!==null&&le!==void 0?le:0,isCellEmpty:u})),G.map(q=>{var S,U,H,F,N,ie,K,J,se,I,L,Y,ge,xe,ae,Pe;const De=q.width!==void 0?(0,e.parseFlexValue)(q.width):{basis:void 0,grow:void 0,shrink:void 0};return Object.assign(Object.assign({},q),{basis:(U=(S=q.basis)!==null&&S!==void 0?S:De.basis)!==null&&U!==void 0?U:0,grow:(F=(H=q.grow)!==null&&H!==void 0?H:De.grow)!==null&&F!==void 0?F:1,shrink:(ie=(N=q.shrink)!==null&&N!==void 0?N:De.shrink)!==null&&ie!==void 0?ie:1,minWidth:(K=q.minWidth)!==null&&K!==void 0?K:100,component:(J=q.component)!==null&&J!==void 0?J:i,disableKeys:(se=q.disableKeys)!==null&&se!==void 0?se:!1,disabled:(I=q.disabled)!==null&&I!==void 0?I:!1,keepFocus:(L=q.keepFocus)!==null&&L!==void 0?L:!1,deleteValue:(Y=q.deleteValue)!==null&&Y!==void 0?Y:c,copyValue:(ge=q.copyValue)!==null&&ge!==void 0?ge:p,pasteValue:(xe=q.pasteValue)!==null&&xe!==void 0?xe:c,prePasteValues:(ae=q.prePasteValues)!==null&&ae!==void 0?ae:b,isCellEmpty:(Pe=q.isCellEmpty)!==null&&Pe!==void 0?Pe:l})})},[D,_,w]);e.useColumns=C})(zn);var mt={},Ye={};Object.defineProperty(Ye,"__esModule",{value:!0});function Ht(e,t,n,r){var o,i=!1,l=0;function c(){o&&clearTimeout(o)}function p(){c(),i=!0}typeof t!="boolean"&&(r=n,n=t,t=void 0);function s(){for(var u=arguments.length,b=new Array(u),f=0;f<u;f++)b[f]=arguments[f];var C=this,w=Date.now()-l;if(i)return;function D(){l=Date.now(),n.apply(C,b)}function _(){o=void 0}r&&!o&&D(),c(),r===void 0&&w>e?D():t!==!0&&(o=setTimeout(r?_:D,r===void 0?e-w:e))}return s.cancel=p,s}function So(e,t,n){return n===void 0?Ht(e,t,!1):Ht(e,n,t!==!1)}Ye.debounce=So;Ye.throttle=Ht;var nt={},Nn=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,o,i;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(o=r;o--!==0;)if(!e(t[o],n[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(i=Object.keys(t),r=i.length,r!==Object.keys(n).length)return!1;for(o=r;o--!==0;)if(!Object.prototype.hasOwnProperty.call(n,i[o]))return!1;for(o=r;o--!==0;){var l=i[o];if(!e(t[l],n[l]))return!1}return!0}return t!==t&&n!==n},Do=x&&x.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(nt,"__esModule",{value:!0});nt.useDeepEqualState=void 0;const yn=B,Mo=Do(Nn),Ro=e=>{const[t,n]=(0,yn.useState)(e),r=(0,yn.useCallback)(o=>{n(i=>{const l=typeof o=="function"?o(i):o;return(0,Mo.default)(l,i)?i:l})},[n]);return[t,r]};nt.useDeepEqualState=Ro;Object.defineProperty(mt,"__esModule",{value:!0});mt.useEdges=void 0;const jo=B,Io=Ye,To=nt,Po=(e,t,n)=>{const[r,o]=(0,To.useDeepEqualState)({top:!0,right:!0,bottom:!0,left:!0});return(0,jo.useEffect)(()=>{const i=(0,Io.throttle)(100,()=>{var c,p,s,u,b,f,C,w,D,_;o({top:((c=e.current)===null||c===void 0?void 0:c.scrollTop)===0,right:((s=(p=e.current)===null||p===void 0?void 0:p.scrollLeft)!==null&&s!==void 0?s:0)>=((b=(u=e.current)===null||u===void 0?void 0:u.scrollWidth)!==null&&b!==void 0?b:0)-(t??0)-1,bottom:((C=(f=e.current)===null||f===void 0?void 0:f.scrollTop)!==null&&C!==void 0?C:0)>=((D=(w=e.current)===null||w===void 0?void 0:w.scrollHeight)!==null&&D!==void 0?D:0)-(n??0)-1,left:((_=e.current)===null||_===void 0?void 0:_.scrollLeft)===0})}),l=e.current;return l==null||l.addEventListener("scroll",i),setTimeout(i,100),()=>{l==null||l.removeEventListener("scroll",i),i.cancel()}},[n,t,e,o]),r};mt.useEdges=Po;var rt={};Object.defineProperty(rt,"__esModule",{value:!0});rt.useDocumentEventListener=void 0;const zo=B,No=(e,t)=>{(0,zo.useEffect)(()=>(document.addEventListener(e,t),()=>{document.removeEventListener(e,t)}),[t,e])};rt.useDocumentEventListener=No;var ht={};Object.defineProperty(ht,"__esModule",{value:!0});ht.useGetBoundingClientRect=void 0;const Gt=B,Ao=Ye,$o=(e,t=200)=>{const n=(0,Gt.useRef)(null),r=(0,Gt.useMemo)(()=>(0,Ao.throttle)(t,!0,()=>{setTimeout(()=>{var o;return n.current=((o=e.current)===null||o===void 0?void 0:o.getBoundingClientRect())||null},0)}),[e,t]);return(0,Gt.useCallback)((o=!1)=>{var i;return o?n.current=((i=e.current)===null||i===void 0?void 0:i.getBoundingClientRect())||null:r(),n.current},[e,r])};ht.useGetBoundingClientRect=$o;var Qt={};(function(e){var t=x&&x.__createBinding||(Object.create?function(l,c,p,s){s===void 0&&(s=p);var u=Object.getOwnPropertyDescriptor(c,p);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[p]}}),Object.defineProperty(l,s,u)}:function(l,c,p,s){s===void 0&&(s=p),l[s]=c[p]}),n=x&&x.__setModuleDefault||(Object.create?function(l,c){Object.defineProperty(l,"default",{enumerable:!0,value:c})}:function(l,c){l.default=c}),r=x&&x.__importStar||function(l){if(l&&l.__esModule)return l;var c={};if(l!=null)for(var p in l)p!=="default"&&Object.prototype.hasOwnProperty.call(l,p)&&t(c,l,p);return n(c,l),c};Object.defineProperty(e,"__esModule",{value:!0}),e.AddRows=e.createAddRowsComponent=void 0;const o=r(B),i=(l={})=>({addRows:c})=>{var p,s;const[u,b]=(0,o.useState)(1),[f,C]=(0,o.useState)(String(u));return o.default.createElement("div",{className:"dsg-add-row"},o.default.createElement("button",{type:"button",className:"dsg-add-row-btn",onClick:()=>c(u)},(p=l.button)!==null&&p!==void 0?p:"Add")," ",o.default.createElement("input",{className:"dsg-add-row-input",value:f,onBlur:()=>C(String(u)),type:"number",min:1,onChange:w=>{C(w.target.value),b(Math.max(1,Math.round(parseInt(w.target.value)||0)))},onKeyDown:w=>{w.key==="Enter"&&c(u)}})," ",(s=l.unit)!==null&&s!==void 0?s:"rows")};e.createAddRowsComponent=i,e.AddRows=(0,e.createAddRowsComponent)(),e.AddRows.displayName="AddRows"})(Qt);var vt={};Object.defineProperty(vt,"__esModule",{value:!0});vt.useDebounceState=void 0;const st=B,Fo=Ye,Wo=(e,t)=>{const[n,r]=(0,st.useState)(e),o=(0,st.useRef)();(0,st.useEffect)(()=>()=>{var l;return(l=o.current)===null||l===void 0?void 0:l.cancel()},[]);const i=(0,st.useMemo)(()=>o.current=(0,Fo.debounce)(t,l=>{r(l)}),[t]);return[n,i]};vt.useDebounceState=Wo;var Jt={};(function(e){var t=x&&x.__createBinding||(Object.create?function(s,u,b,f){f===void 0&&(f=b);var C=Object.getOwnPropertyDescriptor(u,b);(!C||("get"in C?!u.__esModule:C.writable||C.configurable))&&(C={enumerable:!0,get:function(){return u[b]}}),Object.defineProperty(s,f,C)}:function(s,u,b,f){f===void 0&&(f=b),s[f]=u[b]}),n=x&&x.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),r=x&&x.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var b in s)b!=="default"&&Object.prototype.hasOwnProperty.call(s,b)&&t(u,s,b);return n(u,s),u};Object.defineProperty(e,"__esModule",{value:!0}),e.ContextMenu=e.createContextMenuComponent=e.defaultRenderItem=void 0;const o=r(B),i=B,l=rt,c=s=>s.type==="CUT"?o.createElement(o.Fragment,null,"Cut"):s.type==="COPY"?o.createElement(o.Fragment,null,"Copy"):s.type==="PASTE"?o.createElement(o.Fragment,null,"Paste"):s.type==="DELETE_ROW"?o.createElement(o.Fragment,null,"Delete row"):s.type==="DELETE_ROWS"?o.createElement(o.Fragment,null,"Delete rows ",o.createElement("b",null,s.fromRow)," to ",o.createElement("b",null,s.toRow)):s.type==="INSERT_ROW_BELLOW"?o.createElement(o.Fragment,null,"Insert row below"):s.type==="DUPLICATE_ROW"?o.createElement(o.Fragment,null,"Duplicate row"):s.type==="DUPLICATE_ROWS"?o.createElement(o.Fragment,null,"Duplicate rows ",o.createElement("b",null,s.fromRow)," to ",o.createElement("b",null,s.toRow)):s.type;e.defaultRenderItem=c;const p=(s=e.defaultRenderItem)=>({clientX:u,clientY:b,items:f,close:C})=>{const w=(0,i.useRef)(null),D=(0,i.useCallback)(_=>{var T;((T=w.current)===null||T===void 0?void 0:T.contains(_.target))||C()},[C]);return(0,l.useDocumentEventListener)("mousedown",D),o.createElement("div",{className:"dsg-context-menu",style:{left:u+"px",top:b+"px"},ref:w},f.map(_=>o.createElement("div",{key:_.type,onClick:_.action,className:"dsg-context-menu-item"},s(_))))};e.createContextMenuComponent=p,e.ContextMenu=(0,e.createContextMenuComponent)(e.defaultRenderItem),e.ContextMenu.displayName="ContextMenu"})(Jt);var Se={},pt={};Object.defineProperty(pt,"__esModule",{value:!0});pt.parseDom=void 0;const Bo=typeof DOMParser<"u"?new DOMParser:{parseFromString:()=>null},Lo=e=>Bo.parseFromString(e,"text/html");pt.parseDom=Lo;Object.defineProperty(Se,"__esModule",{value:!0});Se.isPrintableUnicode=Se.encodeHtml=Se.parseTextPlainData=Se.parseTextHtmlData=void 0;const Vo=pt,Go=e=>{var t,n;const r=(0,Vo.parseDom)(e.replace(/<br\/?>/g,`
`)),o=r.getElementsByTagName("table")[0];if(o){const l=[];for(let c=0;c<o.rows.length;c++){const p=[];l.push(p);for(let s=0;s<o.rows[c].cells.length;s++)p.push((t=o.rows[c].cells[s].textContent)!==null&&t!==void 0?t:"")}return l}const i=r.getElementsByTagName("span")[0];return i?[[(n=i.textContent)!==null&&n!==void 0?n:""]]:[[""]]};Se.parseTextHtmlData=Go;const Ko=e=>{const t=e.replace(/\r|\n$/g,""),n=[[]];let r=0,o=0,i=!1,l=0;const c=()=>{let p=t.slice(o,r);i&&p[p.length-1]==='"'&&p.includes(`
`)&&(p=p.slice(1,p.length-1).replace(/""/g,'"')),i&&p[p.length-1]!=='"'?p.split(`
`).forEach((s,u,{length:b})=>{n[l].push(s),u<b-1&&(n.push([]),l++)}):n[l].push(p)};for(;r<t.length;)i&&t[r]==='"'&&![void 0,"	",'"'].includes(t[r+1])&&(i=!1),i&&t[r]==='"'&&t[r+1]==='"'&&r++,r===o&&t[r]==='"'&&(i=!0),t[r]==="	"&&(c(),o=r+1,i=!1),t[r]===`
`&&!i&&(c(),n.push([]),o=r+1,l++),r++;return c(),n};Se.parseTextPlainData=Ko;const ko=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");Se.encodeHtml=ko;const Uo=e=>e.match(/^[^\x00-\x20\x7F-\x9F]$/)!==null;Se.isPrintableUnicode=Uo;var An={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getSelectionWithId=e.getSelection=e.getCellWithId=e.getCell=void 0;const t=(i,l,c,p)=>{if(i===null||!l||!c)return null;if(typeof i!="object")throw new Error("Value must be an object or null");const s=p.findIndex(b=>b.id===i.col),u={col:Math.max(0,Math.min(l-1,s===-1?Number(i.col):s-1)),row:Math.max(0,Math.min(c-1,Number(i.row)))};if(isNaN(u.col)||isNaN(u.row))throw new Error("col or cell are not valid positive numbers");return u};e.getCell=t;const n=(i,l)=>{var c;return i?{col:i.col,row:i.row,colId:(c=l[i.col+1])===null||c===void 0?void 0:c.id}:null};e.getCellWithId=n;const r=(i,l,c,p)=>{if(i===null||!l||!c)return null;if(typeof i!="object")throw new Error("Value must be an object or null");const s={min:(0,e.getCell)(i.min,l,c,p),max:(0,e.getCell)(i.max,l,c,p)};if(!s.min||!s.max)throw new Error("min and max must be defined");return s};e.getSelection=r;const o=(i,l)=>i?{min:(0,e.getCellWithId)(i.min,l),max:(0,e.getCellWithId)(i.max,l)}:null;e.getSelectionWithId=o})(An);var gt={};Object.defineProperty(gt,"__esModule",{value:!0});gt.getAllTabbableElements=void 0;const qo=()=>Array.from(document.querySelectorAll("*")).filter(e=>e instanceof HTMLElement&&typeof e.tabIndex=="number"&&e.tabIndex>=0&&!e.disabled&&(!(e instanceof HTMLAnchorElement)||!!e.href||e.getAttribute("tabIndex")!==null)&&getComputedStyle(e).visibility!=="collapse");gt.getAllTabbableElements=qo;var bt={},$n={},Fn={},Wn={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i,l,c){let p=c.initialDeps??[],s;return()=>{var u,b,f,C;let w;c.key&&((u=c.debug)!=null&&u.call(c))&&(w=Date.now());const D=i();if(!(D.length!==p.length||D.some((d,v)=>p[v]!==d)))return s;p=D;let T;if(c.key&&((b=c.debug)!=null&&b.call(c))&&(T=Date.now()),s=l(...D),c.key&&((f=c.debug)!=null&&f.call(c))){const d=Math.round((Date.now()-w)*100)/100,v=Math.round((Date.now()-T)*100)/100,g=v/16,E=(O,P)=>{for(O=String(O);O.length<P;)O=" "+O;return O};console.info(`%c⏱ ${E(v,5)} /${E(d,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*g,120))}deg 100% 31%);`,c==null?void 0:c.key)}return(C=c==null?void 0:c.onChange)==null||C.call(c,s),s}}function n(i,l){if(i===void 0)throw new Error(`Unexpected undefined${l?`: ${l}`:""}`);return i}const r=(i,l)=>Math.abs(i-l)<1,o=(i,l,c)=>{let p;return function(...s){i.clearTimeout(p),p=i.setTimeout(()=>l.apply(this,s),c)}};e.approxEqual=r,e.debounce=o,e.memo=t,e.notUndefined=n})(Wn);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Wn,n=_=>_,r=_=>{const T=Math.max(_.startIndex-_.overscan,0),d=Math.min(_.endIndex+_.overscan,_.count-1),v=[];for(let g=T;g<=d;g++)v.push(g);return v},o=(_,T)=>{const d=_.scrollElement;if(!d)return;const v=_.targetWindow;if(!v)return;const g=O=>{const{width:P,height:z}=O;T({width:Math.round(P),height:Math.round(z)})};if(g(d.getBoundingClientRect()),!v.ResizeObserver)return()=>{};const E=new v.ResizeObserver(O=>{const P=O[0];if(P!=null&&P.borderBoxSize){const z=P.borderBoxSize[0];if(z){g({width:z.inlineSize,height:z.blockSize});return}}g(d.getBoundingClientRect())});return E.observe(d,{box:"border-box"}),()=>{E.unobserve(d)}},i={passive:!0},l=(_,T)=>{const d=_.scrollElement;if(!d)return;const v=()=>{T({width:d.innerWidth,height:d.innerHeight})};return v(),d.addEventListener("resize",v,i),()=>{d.removeEventListener("resize",v)}},c=typeof window>"u"?!0:"onscrollend"in window,p=(_,T)=>{const d=_.scrollElement;if(!d)return;const v=_.targetWindow;if(!v)return;let g=0;const E=c?()=>{}:t.debounce(v,()=>{T(g,!1)},_.options.isScrollingResetDelay),O=Q=>()=>{g=d[_.options.horizontal?"scrollLeft":"scrollTop"],E(),T(g,Q)},P=O(!0),z=O(!1);return z(),d.addEventListener("scroll",P,i),d.addEventListener("scrollend",z,i),()=>{d.removeEventListener("scroll",P),d.removeEventListener("scrollend",z)}},s=(_,T)=>{const d=_.scrollElement;if(!d)return;const v=_.targetWindow;if(!v)return;let g=0;const E=c?()=>{}:t.debounce(v,()=>{T(g,!1)},_.options.isScrollingResetDelay),O=Q=>()=>{g=d[_.options.horizontal?"scrollX":"scrollY"],E(),T(g,Q)},P=O(!0),z=O(!1);return z(),d.addEventListener("scroll",P,i),d.addEventListener("scrollend",z,i),()=>{d.removeEventListener("scroll",P),d.removeEventListener("scrollend",z)}},u=(_,T,d)=>{if(T!=null&&T.borderBoxSize){const v=T.borderBoxSize[0];if(v)return Math.round(v[d.options.horizontal?"inlineSize":"blockSize"])}return Math.round(_.getBoundingClientRect()[d.options.horizontal?"width":"height"])},b=(_,{adjustments:T=0,behavior:d},v)=>{var g,E;const O=_+T;(E=(g=v.scrollElement)==null?void 0:g.scrollTo)==null||E.call(g,{[v.options.horizontal?"left":"top"]:O,behavior:d})},f=(_,{adjustments:T=0,behavior:d},v)=>{var g,E;const O=_+T;(E=(g=v.scrollElement)==null?void 0:g.scrollTo)==null||E.call(g,{[v.options.horizontal?"left":"top"]:O,behavior:d})};class C{constructor(T){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let d=null;const v=()=>d||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:d=new this.targetWindow.ResizeObserver(g=>{g.forEach(E=>{this._measureElement(E.target,E)})}));return{disconnect:()=>{var g;return(g=v())==null?void 0:g.disconnect()},observe:g=>{var E;return(E=v())==null?void 0:E.observe(g,{box:"border-box"})},unobserve:g=>{var E;return(E=v())==null?void 0:E.unobserve(g)}}})(),this.range=null,this.setOptions=d=>{Object.entries(d).forEach(([v,g])=>{typeof g>"u"&&delete d[v]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:n,rangeExtractor:r,onChange:()=>{},measureElement:u,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,...d}},this.notify=(d,v)=>{var g,E;const{startIndex:O,endIndex:P}=this.range??{startIndex:void 0,endIndex:void 0},z=this.calculateRange();(d||O!==(z==null?void 0:z.startIndex)||P!==(z==null?void 0:z.endIndex))&&((E=(g=this.options).onChange)==null||E.call(g,this,v))},this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(d=>d()),this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.observer.disconnect(),this.elementsCache.clear()},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var d;const v=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==v){if(this.cleanup(),!v){this.notify(!1,!1);return}this.scrollElement=v,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((d=this.scrollElement)==null?void 0:d.window)??null,this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,g=>{this.scrollRect=g,this.notify(!1,!1)})),this.unsubs.push(this.options.observeElementOffset(this,(g,E)=>{this.scrollAdjustments=0,this.scrollDirection=E?this.getScrollOffset()<g?"forward":"backward":null,this.scrollOffset=g;const O=this.isScrolling;this.isScrolling=E,this.notify(O!==E,E)}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(d,v)=>{const g=new Map,E=new Map;for(let O=v-1;O>=0;O--){const P=d[O];if(g.has(P.lane))continue;const z=E.get(P.lane);if(z==null||P.end>z.end?E.set(P.lane,P):P.end<z.end&&g.set(P.lane,!0),g.size===this.options.lanes)break}return E.size===this.options.lanes?Array.from(E.values()).sort((O,P)=>O.end===P.end?O.index-P.index:O.end-P.end)[0]:void 0},this.getMeasurementOptions=t.memo(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(d,v,g,E,O)=>(this.pendingMeasuredCacheIndexes=[],{count:d,paddingStart:v,scrollMargin:g,getItemKey:E,enabled:O}),{key:!1}),this.getMeasurements=t.memo(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:d,paddingStart:v,scrollMargin:g,getItemKey:E,enabled:O},P)=>{var z;if(!O)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(G=>{this.itemSizeCache.set(G.key,G.size)}));const Q=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const le=this.measurementsCache.slice(0,Q);for(let G=Q;G<d;G++){let q=(z=this.measurementsCache[G])==null?void 0:z.measureElement;q||(q=J=>{const se=E(G),I=this.elementsCache.get(se);if(!J){I&&(this.observer.unobserve(I),this.elementsCache.delete(se));return}I!==J&&(I&&this.observer.unobserve(I),this.observer.observe(J),this.elementsCache.set(se,J)),J.isConnected&&this.resizeItem(G,this.options.measureElement(J,void 0,this))});const S=E(G),U=this.options.lanes===1?le[G-1]:this.getFurthestMeasurement(le,G),H=U?U.end+this.options.gap:v+g,F=P.get(S),N=typeof F=="number"?F:this.options.estimateSize(G),ie=H+N,K=U?U.lane:G%this.options.lanes;le[G]={index:G,start:H,size:N,end:ie,key:S,lane:K,measureElement:q}}return this.measurementsCache=le,le},{key:!1,debug:()=>this.options.debug}),this.calculateRange=t.memo(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset()],(d,v,g)=>this.range=d.length>0&&v>0?D({measurements:d,outerSize:v,scrollOffset:g}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=t.memo(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(d,v,g,E)=>v===null?[]:d({startIndex:v.startIndex,endIndex:v.endIndex,overscan:g,count:E}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=d=>{const v=this.options.indexAttribute,g=d.getAttribute(v);return g?parseInt(g,10):(console.warn(`Missing attribute name '${v}={index}' on measured element.`),-1)},this._measureElement=(d,v)=>{const g=this.indexFromElement(d),E=this.getMeasurements()[g];if(!E||!d.isConnected){this.elementsCache.forEach((P,z)=>{P===d&&(this.observer.unobserve(d),this.elementsCache.delete(z))});return}const O=this.elementsCache.get(E.key);O!==d&&(O&&this.observer.unobserve(O),this.observer.observe(d),this.elementsCache.set(E.key,d)),this.resizeItem(g,this.options.measureElement(d,v,this))},this.resizeItem=(d,v)=>{const g=this.getMeasurements()[d];if(!g)return;const E=this.itemSizeCache.get(g.key)??g.size,O=v-E;O!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(g,O,this):g.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=O,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(g.index),this.itemSizeCache=new Map(this.itemSizeCache.set(g.key,v)),this.notify(!0,!1))},this.measureElement=d=>{d&&this._measureElement(d,void 0)},this.getVirtualItems=t.memo(()=>[this.getIndexes(),this.getMeasurements()],(d,v)=>{const g=[];for(let E=0,O=d.length;E<O;E++){const P=d[E],z=v[P];g.push(z)}return g},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=d=>{const v=this.getMeasurements();if(v.length!==0)return t.notUndefined(v[w(0,v.length-1,g=>t.notUndefined(v[g]).start,d)])},this.getOffsetForAlignment=(d,v)=>{const g=this.getSize(),E=this.getScrollOffset();v==="auto"&&(d<=E?v="start":d>=E+g?v="end":v="start"),v==="start"?d=d:v==="end"?d=d-g:v==="center"&&(d=d-g/2);const O=this.options.horizontal?"scrollWidth":"scrollHeight",z=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[O]:this.scrollElement[O]:0)-g;return Math.max(Math.min(z,d),0)},this.getOffsetForIndex=(d,v="auto")=>{d=Math.max(0,Math.min(d,this.options.count-1));const g=this.getMeasurements()[d];if(!g)return;const E=this.getSize(),O=this.getScrollOffset();if(v==="auto")if(g.end>=O+E-this.options.scrollPaddingEnd)v="end";else if(g.start<=O+this.options.scrollPaddingStart)v="start";else return[O,v];const P=v==="end"?g.end+this.options.scrollPaddingEnd:g.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(P,v),v]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(d,{align:v="start",behavior:g}={})=>{this.cancelScrollToIndex(),g==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(d,v),{adjustments:void 0,behavior:g})},this.scrollToIndex=(d,{align:v="auto",behavior:g}={})=>{d=Math.max(0,Math.min(d,this.options.count-1)),this.cancelScrollToIndex(),g==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const E=this.getOffsetForIndex(d,v);if(!E)return;const[O,P]=E;this._scrollToOffset(O,{adjustments:void 0,behavior:g}),g!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(d))){const[Q]=t.notUndefined(this.getOffsetForIndex(d,P));t.approxEqual(Q,this.getScrollOffset())||this.scrollToIndex(d,{align:P,behavior:g})}else this.scrollToIndex(d,{align:P,behavior:g})}))},this.scrollBy=(d,{behavior:v}={})=>{this.cancelScrollToIndex(),v==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+d,{adjustments:void 0,behavior:v})},this.getTotalSize=()=>{var d;const v=this.getMeasurements();let g;return v.length===0?g=this.options.paddingStart:g=this.options.lanes===1?((d=v[v.length-1])==null?void 0:d.end)??0:Math.max(...v.slice(-this.options.lanes).map(E=>E.end)),g-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(d,{adjustments:v,behavior:g})=>{this.options.scrollToFn(d,{behavior:g,adjustments:v},this)},this.measure=()=>{var d,v;this.itemSizeCache=new Map,(v=(d=this.options).onChange)==null||v.call(d,this,!1)},this.setOptions(T)}}const w=(_,T,d,v)=>{for(;_<=T;){const g=(_+T)/2|0,E=d(g);if(E<v)_=g+1;else if(E>v)T=g-1;else return g}return _>0?_-1:0};function D({measurements:_,outerSize:T,scrollOffset:d}){const v=_.length-1,E=w(0,v,P=>_[P].start,d);let O=E;for(;O<v&&_[O].end<d+T;)O++;return{startIndex:E,endIndex:O}}e.approxEqual=t.approxEqual,e.debounce=t.debounce,e.memo=t.memo,e.notUndefined=t.notUndefined,e.Virtualizer=C,e.defaultKeyExtractor=n,e.defaultRangeExtractor=r,e.elementScroll=f,e.measureElement=u,e.observeElementOffset=p,e.observeElementRect=o,e.observeWindowOffset=s,e.observeWindowRect=l,e.windowScroll=b})(Fn);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=B,n=En,r=Fn;function o(u){const b=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(u){for(const f in u)if(f!=="default"){const C=Object.getOwnPropertyDescriptor(u,f);Object.defineProperty(b,f,C.get?C:{enumerable:!0,get:()=>u[f]})}}return b.default=u,Object.freeze(b)}const i=o(t),l=typeof document<"u"?i.useLayoutEffect:i.useEffect;function c(u){const b=i.useReducer(()=>({}),{})[1],f={...u,onChange:(w,D)=>{var _;D?n.flushSync(b):b(),(_=u.onChange)==null||_.call(u,w,D)}},[C]=i.useState(()=>new r.Virtualizer(f));return C.setOptions(f),i.useEffect(()=>C._didMount(),[]),l(()=>C._willUpdate()),C}function p(u){return c({observeElementRect:r.observeElementRect,observeElementOffset:r.observeElementOffset,scrollToFn:r.elementScroll,...u})}function s(u){return c({getScrollElement:()=>typeof document<"u"?window:null,observeElementRect:r.observeWindowRect,observeElementOffset:r.observeWindowOffset,scrollToFn:r.windowScroll,initialOffset:()=>typeof document<"u"?window.scrollY:0,...u})}e.useVirtualizer=p,e.useWindowVirtualizer=s,Object.keys(r).forEach(u=>{u!=="default"&&!Object.prototype.hasOwnProperty.call(e,u)&&Object.defineProperty(e,u,{enumerable:!0,get:()=>r[u]})})})($n);var Bn={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function n(){for(var i="",l=0;l<arguments.length;l++){var c=arguments[l];c&&(i=o(i,r(c)))}return i}function r(i){if(typeof i=="string"||typeof i=="number")return i;if(typeof i!="object")return"";if(Array.isArray(i))return n.apply(null,i);if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]"))return i.toString();var l="";for(var c in i)t.call(i,c)&&i[c]&&(l=o(l,c));return l}function o(i,l){return l?i?i+" "+l:i+l:i}e.exports?(n.default=n,e.exports=n):window.classNames=n})()})(Bn);var Qe=Bn.exports,_t={},Ln=x&&x.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_t,"__esModule",{value:!0});_t.Cell=void 0;const Ho=Ln(B),Xo=Ln(Qe),Yo=({children:e,gutter:t,stickyRight:n,active:r,disabled:o,className:i,width:l,left:c})=>Ho.default.createElement("div",{className:(0,Xo.default)("dsg-cell",t&&"dsg-cell-gutter",o&&"dsg-cell-disabled",t&&r&&"dsg-cell-gutter-active",n&&"dsg-cell-sticky-right",i),style:{width:l,left:n?void 0:c}},e);_t.Cell=Yo;var yt={};Object.defineProperty(yt,"__esModule",{value:!0});yt.useMemoizedIndexCallback=void 0;const Qo=B,Jo=(e,t)=>(0,Qo.useMemo)(()=>{const n=new Map;return r=>(n.has(r)||n.set(r,(...o)=>{e(r,...o.slice(0,t))}),n.get(r))},[t,e]);yt.useMemoizedIndexCallback=Jo;var Zo=x&&x.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),el=x&&x.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),tl=x&&x.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&Zo(t,e,n);return el(t,e),t},nl=x&&x.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(bt,"__esModule",{value:!0});bt.Grid=void 0;const Kt=$n,Ie=tl(B),at=nl(Qe),wn=_t,ut=yt,rl=({data:e,columns:t,outerRef:n,innerRef:r,columnWidths:o,hasStickyRightColumn:i,displayHeight:l,headerRowHeight:c,rowHeight:p,rowKey:s,fullWidth:u,selection:b,activeCell:f,rowClassName:C,cellClassName:w,children:D,editing:_,getContextMenuItems:T,setRowData:d,deleteRows:v,duplicateRows:g,insertRowAfter:E,stopEditing:O,onScroll:P})=>{var z,Q,le,G;const q=(0,Kt.useVirtualizer)({count:e.length,getScrollElement:()=>n.current,paddingStart:c,estimateSize:I=>p(I).height,getItemKey:I=>{if(s&&I>0){const L=e[I-1];if(typeof s=="function")return s({rowData:L,rowIndex:I});if(typeof s=="string"&&L instanceof Object&&s in L){const Y=L[s];if(typeof Y=="string"||typeof Y=="number")return Y}}return I},overscan:5}),S=(0,Kt.useVirtualizer)({count:t.length,getScrollElement:()=>n.current,estimateSize:I=>{var L;return(L=o==null?void 0:o[I])!==null&&L!==void 0?L:100},horizontal:!0,getItemKey:I=>{var L;return(L=t[I].id)!==null&&L!==void 0?L:I},overscan:1,rangeExtractor:I=>{const L=(0,Kt.defaultRangeExtractor)(I);return L[0]!==0&&L.unshift(0),i&&L[L.length-1]!==t.length-1&&L.push(t.length-1),L}});(0,Ie.useEffect)(()=>{S.measure()},[S,o]);const U=(0,ut.useMemoizedIndexCallback)(d,1),H=(0,ut.useMemoizedIndexCallback)(v,0),F=(0,ut.useMemoizedIndexCallback)(g,0),N=(0,ut.useMemoizedIndexCallback)(E,0),ie=(z=b==null?void 0:b.min.col)!==null&&z!==void 0?z:f==null?void 0:f.col,K=(Q=b==null?void 0:b.max.col)!==null&&Q!==void 0?Q:f==null?void 0:f.col,J=(le=b==null?void 0:b.min.row)!==null&&le!==void 0?le:f==null?void 0:f.row,se=(G=b==null?void 0:b.max.row)!==null&&G!==void 0?G:f==null?void 0:f.row;return Ie.default.createElement("div",{ref:n,className:"dsg-container",onScroll:P,style:{height:l}},Ie.default.createElement("div",{ref:r,style:{width:u?"100%":S.getTotalSize(),height:q.getTotalSize()}},c>0&&Ie.default.createElement("div",{className:(0,at.default)("dsg-row","dsg-row-header"),style:{width:u?"100%":S.getTotalSize(),height:c}},S.getVirtualItems().map(I=>Ie.default.createElement(wn.Cell,{key:I.key,gutter:I.index===0,stickyRight:i&&I.index===t.length-1,width:I.size,left:I.start,className:(0,at.default)("dsg-cell-header",ie!==void 0&&K!==void 0&&ie<=I.index-1&&K>=I.index-1&&"dsg-cell-header-active",t[I.index].headerClassName)},Ie.default.createElement("div",{className:"dsg-cell-header-container"},t[I.index].title)))),q.getVirtualItems().map(I=>{const L=I.index>=(J??1/0)&&I.index<=(se??-1/0);return Ie.default.createElement("div",{key:I.key,className:(0,at.default)("dsg-row",typeof C=="string"?C:null,typeof C=="function"?C({rowData:e[I.index],rowIndex:I.index}):null),style:{height:I.size,top:I.start,width:u?"100%":S.getTotalSize()}},S.getVirtualItems().map(Y=>{const ge=t[Y.index].cellClassName,xe=t[Y.index].disabled,ae=t[Y.index].component,Pe=xe===!0||typeof xe=="function"&&xe({rowData:e[I.index],rowIndex:I.index}),De=(f==null?void 0:f.row)===I.index&&f.col===Y.index-1;return Ie.default.createElement(wn.Cell,{key:Y.key,gutter:Y.index===0,stickyRight:i&&Y.index===t.length-1,active:Y.index===0&&L,disabled:Pe,className:(0,at.default)(typeof ge=="function"?ge({rowData:e[I.index],rowIndex:I.index,columnId:t[Y.index].id}):ge,typeof w=="function"?w({rowData:e[I.index],rowIndex:I.index,columnId:t[Y.index].id}):w),width:Y.size,left:Y.start},Ie.default.createElement(ae,{rowData:e[I.index],getContextMenuItems:T,disabled:Pe,active:De,columnIndex:Y.index-1,rowIndex:I.index,focus:De&&_,deleteRow:H(I.index),duplicateRow:F(I.index),stopEditing:O,insertRowBelow:N(I.index),setRowData:U(I.index),columnData:t[Y.index].columnData}))}))}),D))};bt.Grid=rl;var Vn={};(function(e){var t=x&&x.__createBinding||(Object.create?function(s,u,b,f){f===void 0&&(f=b);var C=Object.getOwnPropertyDescriptor(u,b);(!C||("get"in C?!u.__esModule:C.writable||C.configurable))&&(C={enumerable:!0,get:function(){return u[b]}}),Object.defineProperty(s,f,C)}:function(s,u,b,f){f===void 0&&(f=b),s[f]=u[b]}),n=x&&x.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),r=x&&x.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var b in s)b!=="default"&&Object.prototype.hasOwnProperty.call(s,b)&&t(u,s,b);return n(u,s),u},o=x&&x.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionRect=void 0;const i=r(B),l=o(Qe),c=(s,u,b,f)=>[[f,s],[u,s],[u,b],[f,b],[f,s]],p=(s,u,b,f)=>`polygon(evenodd, ${[...c(0,"100%","100%",0),...c(s,u,b,f)].map(w=>w.map(D=>typeof D=="number"&&D!==0?D+"px":D).join(" ")).join(",")})`;e.SelectionRect=i.default.memo(({columnWidths:s,columnRights:u,headerRowHeight:b,selection:f,rowHeight:C,activeCell:w,hasStickyRightColumn:D,dataLength:_,viewWidth:T,viewHeight:d,contentWidth:v,edges:g,isCellDisabled:E,editing:O,expandSelection:P})=>{var z,Q,le,G;const q=w?E(w):!1,S=(0,i.useMemo)(()=>{if(!f)return q;for(let I=f.min.col;I<=f.max.col;++I)for(let L=f.min.row;L<=f.max.row;++L)if(!E({col:I,row:L}))return!1;return!0},[q,E,f]);if(!s||!u)return null;const U=I=>I<_-1?1:0,H=I=>I<s.length-(D?3:2)?1:0,F=w&&{width:s[w.col+1]+H(w.col),height:C(w.row).height+U(w.row),left:u[w.col],top:C(w.row).top+b},N=f&&{width:s.slice(f.min.col+1,f.max.col+2).reduce((I,L)=>I+L)+H(f.max.col),height:C(f.max.row).top+C(f.max.row).height-C(f.min.row).top+U(f.max.row),left:u[f.min.col],top:C(f.min.row).top+b},ie=(f==null?void 0:f.min)||w,K=(f==null?void 0:f.max)||w,J=K&&P!==null&&{left:u[K.col]+s[K.col+1],top:C(K.row).top+C(K.row).height+b,transform:`translate(-${K.col<s.length-(D?3:2)?50:100}%, -${K.row<_-1?50:100}%)`},se=ie&&K&&P!==null&&{width:s.slice(ie.col+1,K.col+2).reduce((I,L)=>I+L)+H(K.col),height:C(K.row+P).top+C(K.row+P).height-C(K.row+1).top+U(K.row+P)-1,left:u[ie.col],top:C(K.row).top+C(K.row).height+b+1};return i.default.createElement(i.default.Fragment,null,i.default.createElement("div",{className:"dsg-scrollable-view-container",style:{height:C(_-1).top+C(_-1).height+b,width:v||"100%"}},i.default.createElement("div",{className:(0,l.default)({"dsg-scrollable-view":!0,"dsg-scrollable-view-t":!g.top,"dsg-scrollable-view-r":!g.right,"dsg-scrollable-view-b":!g.bottom,"dsg-scrollable-view-l":!g.left}),style:{top:b,left:s[0],height:d?d-b:0,width:v&&T?T-s[0]-(D?s[s.length-1]:0):`calc(100% - ${s[0]+(D?s[s.length-1]:0)}px)`}})),(N||F)&&i.default.createElement("div",{className:"dsg-selection-col-marker-container",style:{left:(z=N==null?void 0:N.left)!==null&&z!==void 0?z:F==null?void 0:F.left,width:(Q=N==null?void 0:N.width)!==null&&Q!==void 0?Q:F==null?void 0:F.width,height:C(_-1).top+C(_-1).height+b}},i.default.createElement("div",{className:(0,l.default)("dsg-selection-col-marker",S&&"dsg-selection-col-marker-disabled"),style:{top:b}})),(N||F)&&i.default.createElement("div",{className:"dsg-selection-row-marker-container",style:{top:(le=N==null?void 0:N.top)!==null&&le!==void 0?le:F==null?void 0:F.top,height:(G=N==null?void 0:N.height)!==null&&G!==void 0?G:F==null?void 0:F.height,width:v||"100%"}},i.default.createElement("div",{className:(0,l.default)("dsg-selection-row-marker",S&&"dsg-selection-row-marker-disabled"),style:{left:s[0]}})),F&&w&&i.default.createElement("div",{className:(0,l.default)("dsg-active-cell",{"dsg-active-cell-focus":O,"dsg-active-cell-disabled":q}),style:F}),N&&F&&i.default.createElement("div",{className:(0,l.default)("dsg-selection-rect",S&&"dsg-selection-rect-disabled"),style:Object.assign(Object.assign({},N),{clipPath:p(F.top-N.top,F.left-N.left,F.top+F.height-N.top,F.left+F.width-N.left)})}),se&&i.default.createElement("div",{className:(0,l.default)("dsg-expand-rows-rect"),style:se}),J&&i.default.createElement("div",{className:(0,l.default)("dsg-expand-rows-indicator",S&&"dsg-expand-rows-indicator-disabled"),style:J}))}),e.SelectionRect.displayName="SelectionRect"})(Vn);var wt={};Object.defineProperty(wt,"__esModule",{value:!0});wt.useRowHeights=void 0;const kt=B,ol=({value:e,rowHeight:t})=>{const n=(0,kt.useRef)([]),[,r]=(0,kt.useState)(0);return(0,kt.useMemo)(()=>{const o=i=>{if(typeof t=="number")return Math.min(e.length-1,Math.max(-1,Math.floor(i/t)));let l=0,c=n.current.length-1;for(;l<=c;){const p=Math.floor((l+c)/2);if(n.current[p].top<i)l=p+1;else if(n.current[p].top>i)c=p-1;else return p}if(c===n.current.length-1&&e.length>n.current.length&&(!n.current.length||i>=n.current[c].top+n.current[c].height)){let p=c===-1?0:n.current[c].top+n.current[c].height;do{c++;const s=t({rowIndex:c,rowData:e[c]});n.current.push({height:s,top:p}),p+=s}while(p<=i&&c<n.current.length-1)}return c};return{resetAfter:i=>{n.current=n.current.slice(0,i),r(l=>l+1)},getRowSize:i=>{if(typeof t=="number")return{height:t,top:t*i};if(i>=e.length)return{height:0,top:0};if(i<n.current.length)return n.current[i];let l=n.current[n.current.length-1].top+n.current[n.current.length-1].height;for(let c=n.current.length;c<=i;c++){const p=t({rowIndex:c,rowData:e[c]});n.current.push({height:p,top:l}),l+=p}return n.current[i]},getRowIndex:o,totalSize:i=>{if(typeof t=="number")return e.length*t;const l=o(i);return n.current[l].top+n.current[l].height}}},[t,e])};wt.useRowHeights=ol;(function(e){var t=x&&x.__createBinding||(Object.create?function(S,U,H,F){F===void 0&&(F=H);var N=Object.getOwnPropertyDescriptor(U,H);(!N||("get"in N?!U.__esModule:N.writable||N.configurable))&&(N={enumerable:!0,get:function(){return U[H]}}),Object.defineProperty(S,F,N)}:function(S,U,H,F){F===void 0&&(F=H),S[F]=U[H]}),n=x&&x.__setModuleDefault||(Object.create?function(S,U){Object.defineProperty(S,"default",{enumerable:!0,value:U})}:function(S,U){S.default=U}),r=x&&x.__importStar||function(S){if(S&&S.__esModule)return S;var U={};if(S!=null)for(var H in S)H!=="default"&&Object.prototype.hasOwnProperty.call(S,H)&&t(U,S,H);return n(U,S),U},o=x&&x.__awaiter||function(S,U,H,F){function N(ie){return ie instanceof H?ie:new H(function(K){K(ie)})}return new(H||(H=Promise))(function(ie,K){function J(L){try{I(F.next(L))}catch(Y){K(Y)}}function se(L){try{I(F.throw(L))}catch(Y){K(Y)}}function I(L){L.done?ie(L.value):N(L.value).then(J,se)}I((F=F.apply(S,U||[])).next())})},i=x&&x.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(e,"__esModule",{value:!0}),e.DataSheetGrid=void 0;const l=r(B),c=xn,p=Co,s=zn,u=mt,b=nt,f=rt,C=ht,w=Qt,D=vt,_=i(Nn),T=Jt,d=Se,v=An,g=gt,E=bt,O=Vn,P=wt,z=[],Q=[],le=()=>({}),G=()=>null,q=({rowData:S})=>Object.assign({},S);e.DataSheetGrid=l.default.memo(l.default.forwardRef(({value:S=z,className:U,style:H,height:F=400,onChange:N=G,columns:ie=Q,rowHeight:K=40,headerRowHeight:J=typeof K=="number"?K:40,gutterColumn:se,stickyRightColumn:I,rowKey:L,addRowsComponent:Y=w.AddRows,createRow:ge=le,autoAddRow:xe=!1,lockRows:ae=!1,disableExpandSelection:Pe=!1,duplicateRow:De=q,contextMenuComponent:Hn=T.ContextMenu,disableContextMenu:Xn=!1,onFocus:Zt=G,onBlur:en=G,onActiveCellChange:tn=G,onSelectionChange:nn=G,rowClassName:Yn,cellClassName:Qn,onScroll:Jn},Zn)=>{var It,Tt,Pt,zt,Nt,At;const Fe=(0,l.useRef)(null),rn=Xn||ae,A=(0,s.useColumns)(ie,se,I),ee=!!I,ot=(0,l.useRef)(null),Oe=(0,l.useRef)(null),$t=(0,l.useRef)(null),Ft=(0,l.useRef)(null),[er,tr]=(0,D.useDebounceState)(1,100),{getRowSize:We,totalSize:nr,getRowIndex:on}=(0,P.useRowHeights)({value:S,rowHeight:K}),ln=Math.min(F,J+nr(F)+er),{width:Be,height:Ae}=(0,p.useResizeDetector)({targetRef:Oe,refreshMode:"throttle",refreshRate:100});tr(Ae?ln-Ae:0);const rr=(0,u.useEdges)(Oe,Be,Ae),{fullWidth:sn,totalWidth:or,columnWidths:be,columnRights:Ee}=(0,c.useColumnWidths)(A,Be),[Le,_e]=(0,l.useState)(null),[Ve,lr]=(0,l.useState)([]),[ne,ue]=(0,l.useState)(!1),[Ge,an]=(0,l.useState)(0),[Ke,un]=(0,l.useState)(null),[m,X]=(0,b.useDeepEqualState)(null),[ce,k]=(0,b.useDeepEqualState)(null),h=(0,l.useMemo)(()=>m&&ce&&{min:{col:Math.min(m.col,ce.col),row:Math.min(m.row,ce.row)},max:{col:Math.max(m.col,ce.col),row:Math.max(m.row,ce.row)}},[m,ce]),[Me,ke]=(0,b.useDeepEqualState)({columns:!1,rows:!1,active:!1}),ir=Pe||ne||Me.active||(m==null?void 0:m.row)===(S==null?void 0:S.length)-1||(h==null?void 0:h.max.row)===(S==null?void 0:S.length)-1||m&&A.slice(((It=h==null?void 0:h.min.col)!==null&&It!==void 0?It:m.col)+1,((Tt=h==null?void 0:h.max.col)!==null&&Tt!==void 0?Tt:m.col)+2).every(a=>a.disabled===!0)?null:Ge,cn=(0,C.useGetBoundingClientRect)(ot),dn=(0,C.useGetBoundingClientRect)(Oe);(0,l.useEffect)(()=>{var a;m!==null&&(document.activeElement.blur(),(a=window.getSelection())===null||a===void 0||a.removeAllRanges())},[m!==null]);const $e=(0,l.useCallback)((a,y=!1,M=!1)=>{const R=cn(y),$=M&&dn(y);if(R&&Ee&&be){let te=a.clientX-R.left,j=a.clientY-R.top;return $&&(a.clientY-$.top<=J&&(j=0),a.clientX-$.left<=be[0]&&(te=0),ee&&$.right-a.clientX<=be[be.length-1]&&(te=Ee[Ee.length-2]+1)),{col:Ee.findIndex(V=>te<V)-1,row:on(j-J)}}return null},[Ee,be,S.length,cn,dn,J,ee,on]),me=(0,l.useRef)(S);me.current=S;const he=(0,l.useCallback)(a=>{const y=A[a.col+1].disabled;return!!(typeof y=="function"?y({rowData:me.current[a.row],rowIndex:a.row}):y)},[A]),Re=(0,l.useCallback)((a,y=1)=>{ae||(k(null),ue(!1),N([...me.current.slice(0,a+1),...new Array(y).fill(0).map(ge),...me.current.slice(a+1)],[{type:"CREATE",fromRowIndex:a+1,toRowIndex:a+1+y}]),X(M=>({col:(M==null?void 0:M.col)||0,row:a+y,doNotScrollX:!0})))},[ge,ae,N,X,k]),Ue=(0,l.useCallback)((a,y=a)=>{ae||(N([...me.current.slice(0,y+1),...me.current.slice(a,y+1).map((M,R)=>De({rowData:M,rowIndex:R+a})),...me.current.slice(y+1)],[{type:"CREATE",fromRowIndex:y+1,toRowIndex:y+2+y-a}]),X({col:0,row:y+1,doNotScrollX:!0}),k({col:A.length-(ee?3:2),row:2*y-a+1,doNotScrollX:!0}),ue(!1))},[A.length,De,ae,N,X,k,ee]),je=(0,l.useCallback)(a=>{if(!(!Ae||!Be)){if(!a.doNotScrollY){const y=We(a.row).top,M=We(a.row).top+We(a.row).height+J-Ae+1,R=Oe.current.scrollTop;R>y?Oe.current.scrollTop=y:R<M&&(Oe.current.scrollTop=M)}if(Ee&&be&&Oe.current&&!a.doNotScrollX){const y=Ee[a.col]-Ee[0],M=Ee[a.col]+be[a.col+1]+(ee?be[be.length-1]:0)-Be+1,R=Oe.current.scrollLeft;R>y?Oe.current.scrollLeft=y:R<M&&(Oe.current.scrollLeft=M)}}},[Ae,Be,J,Ee,be,We,ee]);(0,l.useEffect)(()=>{ce&&je(ce)},[ce,je]),(0,l.useEffect)(()=>{m&&je(m)},[m,je]);const sr=(0,l.useCallback)((a,y)=>{var M,R;N([...(M=me.current)===null||M===void 0?void 0:M.slice(0,a),y,...(R=me.current)===null||R===void 0?void 0:R.slice(a+1)],[{type:"UPDATE",fromRowIndex:a,toRowIndex:a+1}])},[N]),qe=(0,l.useCallback)((a,y=a)=>{ae||(ue(!1),X(M=>{const R=Math.min(me.current.length-2-y+a,a);return R<0?null:M&&{col:M.col,row:R}}),k(null),N([...me.current.slice(0,a),...me.current.slice(y+1)],[{type:"DELETE",fromRowIndex:a,toRowIndex:y+1}]))},[ae,N,X,k]),lt=(0,l.useCallback)((a=!0)=>{if(!m)return;const y=(h==null?void 0:h.min)||m,M=(h==null?void 0:h.max)||m;if(S.slice(y.row,M.row+1).every(($,te)=>A.every(j=>j.isCellEmpty({rowData:$,rowIndex:te+y.row})))){a&&qe(y.row,M.row);return}const R=[...S];for(let $=y.row;$<=M.row;++$)for(let te=y.col;te<=M.col;++te)if(!he({col:te,row:$})){const{deleteValue:j=({rowData:V})=>V}=A[te+1];R[$]=j({rowData:R[$],rowIndex:$})}if(a&&(0,_.default)(R,S)){X({col:0,row:y.row,doNotScrollX:!0}),k({col:A.length-(ee?3:2),row:M.row,doNotScrollX:!0});return}N(R,[{type:"UPDATE",fromRowIndex:y.row,toRowIndex:M.row+1}])},[m,A,S,qe,he,N,h==null?void 0:h.max,h==null?void 0:h.min,X,k,ee]),Wt=(0,l.useCallback)(({nextRow:a=!0}={})=>{(m==null?void 0:m.row)===me.current.length-1?a&&xe?Re(m.row):ue(!1):(ue(!1),a&&X(y=>y&&{col:y.col,row:y.row+1}))},[m==null?void 0:m.row,xe,Re,X]),Je=(0,l.useCallback)(a=>o(void 0,void 0,void 0,function*(){var y,M;if(!ne&&m){const R=[],$=(h==null?void 0:h.min)||m,te=(h==null?void 0:h.max)||m;for(let W=$.row;W<=te.row;++W){R.push([]);for(let re=$.col;re<=te.col;++re){const{copyValue:oe=()=>null}=A[re+1];R[W-$.row].push(oe({rowData:S[W],rowIndex:W}))}}const j=R.map(W=>W.join("	")).join(`
`),V=`<table>${R.map(W=>`<tr>${W.map(re=>`<td>${(0,d.encodeHtml)(String(re??"")).replace(/\n/g,"<br/>")}</td>`).join("")}</tr>`).join("")}</table>`;if(a!==void 0){(y=a.clipboardData)===null||y===void 0||y.setData("text/plain",j),(M=a.clipboardData)===null||M===void 0||M.setData("text/html",V),a.preventDefault();return}let Z=!1;if(navigator.clipboard.write!==void 0){const W=new Blob([j],{type:"text/plain"}),re=new Blob([V],{type:"text/html"}),oe=[new ClipboardItem({"text/plain":W,"text/html":re})];yield navigator.clipboard.write(oe).then(()=>{Z=!0})}else navigator.clipboard.writeText!==void 0?yield navigator.clipboard.writeText(j).then(()=>{Z=!0}):document.execCommand!==void 0&&document.execCommand("copy")&&(Z=!0);Z||alert("This action is unavailable in your browser, but you can still use Ctrl+C for copy or Ctrl+X for cut")}}),[m,A,S,ne,h]);(0,f.useDocumentEventListener)("copy",Je);const Bt=(0,l.useCallback)(a=>{!ne&&m&&(Je(a),lt(!1))},[m,lt,ne,Je]);(0,f.useDocumentEventListener)("cut",Bt);const Ze=(0,l.useCallback)(a=>o(void 0,void 0,void 0,function*(){var y,M;if(!ne&&m){const R=(h==null?void 0:h.min)||m,$=(h==null?void 0:h.max)||m,te=yield Promise.all(a[0].map((j,V)=>{var Z,W;const re=(Z=A[R.col+V+1])===null||Z===void 0?void 0:Z.prePasteValues,oe=a.map(ve=>ve[V]);return(W=re==null?void 0:re(oe))!==null&&W!==void 0?W:oe}));if(a=a.map((j,V)=>te.map(Z=>Z[V])),a.length===1){const j=[...S];for(let V=0;V<a[0].length;V++){const Z=(y=A[R.col+V+1])===null||y===void 0?void 0:y.pasteValue;if(Z)for(let W=R.row;W<=$.row;W++)he({col:V+R.col,row:W})||(j[W]=yield Z({rowData:j[W],value:a[0][V],rowIndex:W}))}N(j,[{type:"UPDATE",fromRowIndex:R.row,toRowIndex:$.row+1}]),X({col:R.col,row:R.row}),k({col:Math.min(R.col+a[0].length-1,A.length-(ee?3:2)),row:$.row})}else{let j=[...S];const V=R.row+a.length-S.length;V>0&&(ae?a.splice(a.length-V,V):j=[...j,...new Array(V).fill(0).map(()=>ge())]);for(let W=0;W<a[0].length&&R.col+W<A.length-(ee?2:1);W++){const re=(M=A[R.col+W+1])===null||M===void 0?void 0:M.pasteValue;if(re)for(let oe=0;oe<a.length;oe++)he({col:R.col+W,row:R.row+oe})||(j[R.row+oe]=yield re({rowData:j[R.row+oe],value:a[oe][W],rowIndex:R.row+oe}))}const Z=[{type:"UPDATE",fromRowIndex:R.row,toRowIndex:R.row+a.length-(!ae&&V>0?V:0)}];V>0&&!ae&&Z.push({type:"CREATE",fromRowIndex:R.row+a.length-V,toRowIndex:R.row+a.length}),N(j,Z),X({col:R.col,row:R.row}),k({col:Math.min(R.col+a[0].length-1,A.length-(ee?3:2)),row:R.row+a.length-1})}}}),[m,A,ge,S,ne,ee,he,ae,N,h==null?void 0:h.max,h==null?void 0:h.min,X,k]),ar=(0,l.useCallback)(a=>{var y,M,R,$,te,j;if(m&&!ne){let V=[[""]];!((y=a.clipboardData)===null||y===void 0)&&y.types.includes("text/html")?V=(0,d.parseTextHtmlData)((M=a.clipboardData)===null||M===void 0?void 0:M.getData("text/html")):!((R=a.clipboardData)===null||R===void 0)&&R.types.includes("text/plain")?V=(0,d.parseTextPlainData)(($=a.clipboardData)===null||$===void 0?void 0:$.getData("text/plain")):!((te=a.clipboardData)===null||te===void 0)&&te.types.includes("text")&&(V=(0,d.parseTextPlainData)((j=a.clipboardData)===null||j===void 0?void 0:j.getData("text"))),Ze(V),a.preventDefault()}},[m,Ze,ne]);(0,f.useDocumentEventListener)("paste",ar);const ur=(0,l.useCallback)(a=>{var y,M,R;if(Le&&Ve.length)return;const $=a.button===2||a.button===0&&a.ctrlKey,te=((y=ot.current)===null||y===void 0?void 0:y.contains(a.target))||!1,j=te?$e(a,!0,!0):null;if(!te&&ne&&m&&A[m.col+1].keepFocus)return;if(a.target instanceof HTMLElement&&a.target.className.includes("dsg-expand-rows-indicator")){un(Math.max((M=m==null?void 0:m.row)!==null&&M!==void 0?M:0,(R=h==null?void 0:h.max.row)!==null&&R!==void 0?R:0));return}const V=j&&m&&m.col===j.col&&m.row===j.row&&!he(m);if(V&&ne)return;const Z=(j==null?void 0:j.col)===A.length-2&&ee,W=$&&h&&j&&j.row>=h.min.row&&j.row<=h.max.row&&j.col>=h.min.col&&j.col<=h.max.col,re=$&&h&&j&&j.row===-1&&j.col>=h.min.col&&j.col<=h.max.col,oe=$&&h&&j&&j.row>=h.min.row&&j.row<=h.max.row&&j.col===-1,ve=Z&&h&&j&&j.row>=h.min.row&&j.row<=h.max.row;if($&&!rn&&_e({x:a.clientX,y:a.clientY,cursorIndex:j}),(!(a.shiftKey&&m)||$)&&S.length>0&&X(j&&{col:(W||re)&&m?m.col:Math.max(0,Z?0:j.col),row:(W||oe||ve)&&m?m.row:Math.max(0,j.row),doNotScrollX:!!(W&&m||Z||j.col===-1),doNotScrollY:!!(W&&m||j.row===-1)}),V&&!$&&(Fe.current=m),ue(!!(V&&!$)),ke(j&&!$?{columns:j.col!==-1&&!Z||!!(a.shiftKey&&m),rows:j.row!==-1||!!(a.shiftKey&&m),active:!0}:{columns:!1,rows:!1,active:!1}),a.shiftKey&&m&&!$)k(j&&{col:Math.max(0,j.col-(Z?1:0)),row:Math.max(0,j.row)});else if(!W){if(j&&((j==null?void 0:j.col)===-1||(j==null?void 0:j.row)===-1||Z)){let de=j.col,pe=j.row,fe=!1,ye=!1;(j.col===-1||Z)&&(de=A.length-(ee?3:2),fe=!0),j.row===-1&&(pe=S.length-1,ye=!0),re&&ce&&(de=ce.col,ye=!0),(oe||ve)&&ce&&(pe=ce.row,fe=!0),k({col:de,row:pe,doNotScrollX:fe,doNotScrollY:ye})}else k(null);te&&a.preventDefault()}},[Le,Ve.length,$e,ne,m,A,he,h,ee,rn,ke,X,k,ce,S.length]);(0,f.useDocumentEventListener)("mousedown",ur);const cr=(0,l.useCallback)(()=>{var a,y,M,R,$,te,j,V,Z;if(Ke!==null){if(Ge>0&&m){let W=[];const re=(h==null?void 0:h.min)||m,oe=(h==null?void 0:h.max)||m;for(let ve=re.row;ve<=oe.row;++ve){W.push([]);for(let de=re.col;de<=oe.col;++de){const{copyValue:pe=()=>null}=A[de+1];W[ve-re.row].push(String((a=pe({rowData:S[ve],rowIndex:ve}))!==null&&a!==void 0?a:""))}}Promise.all(W[0].map((ve,de)=>{var pe,fe;const ye=(pe=A[re.col+de+1])===null||pe===void 0?void 0:pe.prePasteValues,we=W.map(vr=>vr[de]);return(fe=ye==null?void 0:ye(we))!==null&&fe!==void 0?fe:we})).then(ve=>{var de;W=W.map((fe,ye)=>ve.map(we=>we[ye]));const pe=[...S];for(let fe=0;fe<W[0].length;fe++){const ye=(de=A[re.col+fe+1])===null||de===void 0?void 0:de.pasteValue;if(ye)for(let we=oe.row+1;we<=oe.row+Ge;we++)he({col:fe+re.col,row:we})||(pe[we]=ye({rowData:pe[we],value:W[(we-oe.row-1)%W.length][fe],rowIndex:we}))}N(pe,[{type:"UPDATE",fromRowIndex:oe.row+1,toRowIndex:oe.row+1+Ge}])}),an(0),X({col:Math.min((y=m==null?void 0:m.col)!==null&&y!==void 0?y:1/0,(M=h==null?void 0:h.min.col)!==null&&M!==void 0?M:1/0),row:Math.min((R=m==null?void 0:m.row)!==null&&R!==void 0?R:1/0,($=h==null?void 0:h.min.row)!==null&&$!==void 0?$:1/0),doNotScrollX:!0,doNotScrollY:!0}),k({col:Math.max((te=m==null?void 0:m.col)!==null&&te!==void 0?te:0,(j=h==null?void 0:h.max.col)!==null&&j!==void 0?j:0),row:Math.max((V=m==null?void 0:m.row)!==null&&V!==void 0?V:0,(Z=h==null?void 0:h.max.row)!==null&&Z!==void 0?Z:0)+Ge})}un(null)}ke({columns:!1,rows:!1,active:!1})},[Ke,ke,Ge,m,h==null?void 0:h.min,h==null?void 0:h.max,S,N,X,k,A,he]);(0,f.useDocumentEventListener)("mouseup",cr);const dr=(0,l.useCallback)(a=>{if(Ke!==null){const y=$e(a);y&&(an(Math.max(0,y.row-Ke)),je({col:y.col,row:Math.max(y.row,Ke)}))}if(Me.active){const y=$e(a),M=A.length-(ee?3:2);k(y&&{col:Me.columns?Math.max(0,Math.min(M,y.col)):M,row:Me.rows?Math.max(0,y.row):S.length-1,doNotScrollX:!Me.columns,doNotScrollY:!Me.rows}),ue(!1)}},[je,Me.active,Me.columns,Me.rows,$e,A.length,ee,k,S.length,Ke]);(0,f.useDocumentEventListener)("mousemove",dr);const fr=(0,l.useCallback)(a=>{if(m&&!a.isComposing){if(a.key==="Tab"&&!a.shiftKey&&m.col===A.length-(ee?3:2)&&!A[m.col+1].disableKeys)if(m.row===S.length-1){if(Ft.current){a.preventDefault(),X(null),k(null),ue(!1);const y=(0,g.getAllTabbableElements)(),M=y.indexOf(Ft.current);y[(M+1)%y.length].focus();return}}else{X(y=>{var M;return{col:0,row:((M=y==null?void 0:y.row)!==null&&M!==void 0?M:0)+1}}),k(null),ue(!1),a.preventDefault();return}if(a.key==="Tab"&&a.shiftKey&&m.col===0&&!A[m.col+1].disableKeys)if(m.row===0){if($t.current){a.preventDefault(),X(null),k(null),ue(!1);const y=(0,g.getAllTabbableElements)(),M=y.indexOf($t.current);y[(M-1+y.length)%y.length].focus();return}}else{X(y=>{var M;return{col:A.length-(ee?3:2),row:((M=y==null?void 0:y.row)!==null&&M!==void 0?M:1)-1}}),k(null),ue(!1),a.preventDefault();return}if(a.key.startsWith("Arrow")||a.key==="Tab"){if(ne&&A[m.col+1].disableKeys||ne&&["ArrowLeft","ArrowRight"].includes(a.key))return;const y=([M,R],$)=>$&&{col:Math.max(0,Math.min(A.length-(ee?3:2),$.col+M)),row:Math.max(0,Math.min(S.length-1,$.row+R))};if(a.key==="Tab"&&a.shiftKey)X(M=>y([-1,0],M)),k(null);else{const M={ArrowDown:[0,1],ArrowUp:[0,-1],ArrowLeft:[-1,0],ArrowRight:[1,0],Tab:[1,0]}[a.key];(a.ctrlKey||a.metaKey)&&(M[0]*=A.length,M[1]*=S.length),a.shiftKey?k(R=>y(M,R||m)):(X(R=>y(M,R)),k(null))}ue(!1),a.preventDefault()}else a.key==="Escape"?(!ne&&!ce&&X(null),k(null),ue(!1)):(a.key==="Enter"||a.key==="F2")&&!a.ctrlKey&&!a.metaKey&&!a.altKey&&!a.shiftKey?(k(null),ne?A[m.col+1].disableKeys||(Wt(),a.preventDefault()):he(m)||(Fe.current=m,ue(!0),je(m),a.preventDefault())):a.key==="Enter"&&!a.ctrlKey&&!a.metaKey&&!a.altKey&&a.shiftKey?Re((h==null?void 0:h.max.row)||m.row):a.key==="d"&&(a.ctrlKey||a.metaKey)&&!a.altKey&&!a.shiftKey?(Ue((h==null?void 0:h.min.row)||m.row,h==null?void 0:h.max.row),a.preventDefault()):((0,d.isPrintableUnicode)(a.key)||a.code.match(/Key[A-Z]$/))&&!a.ctrlKey&&!a.metaKey&&!a.altKey?!ne&&!he(m)&&(Fe.current=m,k(null),ue(!0),je(m)):["Backspace","Delete"].includes(a.key)?ne||(lt(),a.preventDefault()):a.key==="a"&&(a.ctrlKey||a.metaKey)&&(ne||(X({col:0,row:0,doNotScrollY:!0,doNotScrollX:!0}),k({col:A.length-(ee?3:2),row:S.length-1,doNotScrollY:!0,doNotScrollX:!0}),a.preventDefault()))}},[m,A,S.length,lt,Ue,ne,Re,he,je,h==null?void 0:h.max.row,h==null?void 0:h.min.row,ce,X,k,Wt,ee]);(0,f.useDocumentEventListener)("keydown",fr);const mr=(0,l.useCallback)(a=>{var y;const M=((y=ot.current)===null||y===void 0?void 0:y.contains(a.target))||!1,R=M?$e(a,!0,!0):null,$=R&&m&&m.col===R.col&&m.row===R.row&&ne;M&&!$&&a.preventDefault()},[$e,m,ne]);(0,f.useDocumentEventListener)("contextmenu",mr),(0,l.useEffect)(()=>{const a=[];(m==null?void 0:m.row)!==void 0&&a.push({type:"COPY",action:()=>{Je(),_e(null)}},{type:"CUT",action:()=>{Bt(),_e(null)}},{type:"PASTE",action:()=>o(void 0,void 0,void 0,function*(){if(navigator.clipboard.read!==void 0)(yield navigator.clipboard.read()).forEach(M=>o(void 0,void 0,void 0,function*(){let R=[[""]];if(M.types.includes("text/html")){const $=yield M.getType("text/html");R=(0,d.parseTextHtmlData)(yield $.text())}else if(M.types.includes("text/plain")){const $=yield M.getType("text/plain");R=(0,d.parseTextPlainData)(yield $.text())}else if(M.types.includes("text")){const $=yield M.getType("text");R=(0,d.parseTextHtmlData)(yield $.text())}Ze(R)}));else if(navigator.clipboard.readText!==void 0){const y=yield navigator.clipboard.readText();Ze((0,d.parseTextPlainData)(y))}else alert("This action is unavailable in your browser, but you can still use Ctrl+V for paste");_e(null)})}),(h==null?void 0:h.max.row)!==void 0?a.push({type:"INSERT_ROW_BELLOW",action:()=>{_e(null),Re(h.max.row)}}):(m==null?void 0:m.row)!==void 0&&a.push({type:"INSERT_ROW_BELLOW",action:()=>{_e(null),Re(m.row)}}),(h==null?void 0:h.min.row)!==void 0&&h.min.row!==h.max.row?a.push({type:"DUPLICATE_ROWS",fromRow:h.min.row+1,toRow:h.max.row+1,action:()=>{_e(null),Ue(h.min.row,h.max.row)}}):(m==null?void 0:m.row)!==void 0&&a.push({type:"DUPLICATE_ROW",action:()=>{_e(null),Ue(m.row)}}),(h==null?void 0:h.min.row)!==void 0&&h.min.row!==h.max.row?a.push({type:"DELETE_ROWS",fromRow:h.min.row+1,toRow:h.max.row+1,action:()=>{_e(null),qe(h.min.row,h.max.row)}}):(m==null?void 0:m.row)!==void 0&&a.push({type:"DELETE_ROW",action:()=>{_e(null),qe(m.row)}}),lr(a),a.length||_e(null)},[h,m,qe,Ue,Re,Bt,Je,Ze]);const fn=(0,l.useRef)(Ve);fn.current=Ve;const hr=(0,l.useCallback)(()=>fn.current,[]);(0,l.useImperativeHandle)(Zn,()=>({activeCell:(0,v.getCellWithId)(m,A),selection:(0,v.getSelectionWithId)(h??(m?{min:m,max:m}:null),A),setSelection:a=>{const y=(0,v.getSelection)(a,A.length-(ee?2:1),S.length,A);X((y==null?void 0:y.min)||null),ue(!1),ke({columns:!1,active:!1,rows:!1}),k((y==null?void 0:y.max)||null)},setActiveCell:a=>{const y=(0,v.getCell)(a,A.length-(ee?2:1),S.length,A);X(y),ue(!1),ke({columns:!1,active:!1,rows:!1}),k(null)}}));const ze=(0,l.useRef)({onFocus:Zt,onBlur:en,onActiveCellChange:tn,onSelectionChange:nn});return ze.current.onFocus=Zt,ze.current.onBlur=en,ze.current.onActiveCellChange=tn,ze.current.onSelectionChange=nn,(0,l.useEffect)(()=>{Fe.current&&(ne?ze.current.onFocus({cell:(0,v.getCellWithId)(Fe.current,A)}):ze.current.onBlur({cell:(0,v.getCellWithId)(Fe.current,A)}))},[ne,A]),(0,l.useEffect)(()=>{ze.current.onActiveCellChange({cell:(0,v.getCellWithId)(m,A)})},[m==null?void 0:m.col,m==null?void 0:m.row,A]),(0,l.useEffect)(()=>{ze.current.onSelectionChange({selection:(0,v.getSelectionWithId)(h??(m?{min:m,max:m}:null),A)})},[(Pt=h==null?void 0:h.min.col)!==null&&Pt!==void 0?Pt:m==null?void 0:m.col,(zt=h==null?void 0:h.min.row)!==null&&zt!==void 0?zt:m==null?void 0:m.row,(Nt=h==null?void 0:h.max.col)!==null&&Nt!==void 0?Nt:m==null?void 0:m.col,(At=h==null?void 0:h.max.row)!==null&&At!==void 0?At:m==null?void 0:m.row,m==null?void 0:m.col,m==null?void 0:m.row,A]),l.default.createElement("div",{className:U,style:H},l.default.createElement("div",{ref:$t,tabIndex:ie.length&&S.length?0:void 0,onFocus:a=>{a.target.blur(),X({col:0,row:0})}}),l.default.createElement(E.Grid,{columns:A,outerRef:Oe,columnWidths:be,hasStickyRightColumn:ee,displayHeight:ln,data:S,fullWidth:sn,headerRowHeight:J,activeCell:m,innerRef:ot,rowHeight:We,rowKey:L,selection:h,rowClassName:Yn,editing:ne,getContextMenuItems:hr,setRowData:sr,deleteRows:qe,insertRowAfter:Re,duplicateRows:Ue,stopEditing:Wt,cellClassName:Qn,onScroll:Jn},l.default.createElement(O.SelectionRect,{columnRights:Ee,columnWidths:be,activeCell:m,selection:h,headerRowHeight:J,rowHeight:We,hasStickyRightColumn:ee,dataLength:S.length,viewHeight:Ae,viewWidth:Be,contentWidth:sn?void 0:or,edges:rr,editing:ne,isCellDisabled:he,expandSelection:ir})),l.default.createElement("div",{ref:Ft,tabIndex:ie.length&&S.length?0:void 0,onFocus:a=>{a.target.blur(),X({col:A.length-(ee?3:2),row:S.length-1})}}),!ae&&Y&&l.default.createElement(Y,{addRows:a=>Re(S.length-1,a)}),Le&&Ve.length>0&&l.default.createElement(Hn,{clientX:Le.x,clientY:Le.y,cursorIndex:Le.cursorIndex,items:Ve,close:()=>_e(null)}))})),e.DataSheetGrid.displayName="DataSheetGrid"})(Xt);var Ot={},ll=x&&x.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n},il=x&&x.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ot,"__esModule",{value:!0});Ot.StaticDataSheetGrid=void 0;const sl=B,al=Xt,On=il(B);Ot.StaticDataSheetGrid=On.default.forwardRef((e,t)=>{var{columns:n,gutterColumn:r,stickyRightColumn:o,addRowsComponent:i,createRow:l,duplicateRow:c,style:p,rowKey:s,onFocus:u,onBlur:b,onActiveCellChange:f,onSelectionChange:C,rowClassName:w,rowHeight:D}=e,_=ll(e,["columns","gutterColumn","stickyRightColumn","addRowsComponent","createRow","duplicateRow","style","rowKey","onFocus","onBlur","onActiveCellChange","onSelectionChange","rowClassName","rowHeight"]);const[T]=(0,sl.useState)({columns:n,gutterColumn:r,stickyRightColumn:o,addRowsComponent:i,createRow:l,duplicateRow:c,style:p,rowKey:s,onFocus:u,onBlur:b,onActiveCellChange:f,onSelectionChange:C,rowClassName:w,rowHeight:D});return On.default.createElement(al.DataSheetGrid,Object.assign({},T,_,{rowHeight:typeof D=="number"?D:T.rowHeight,ref:t}))});var Te={},Et={};Object.defineProperty(Et,"__esModule",{value:!0});Et.useFirstRender=void 0;const ul=B,cl=()=>{const e=(0,ul.useRef)(!0),t=e.current;return e.current=!1,t};Et.useFirstRender=cl;var dl=x&&x.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),fl=x&&x.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ml=x&&x.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&dl(t,e,n);return fl(t,e),t},hl=x&&x.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Te,"__esModule",{value:!0});Te.createTextColumn=Te.textColumn=void 0;const He=ml(B),vl=hl(Qe),pl=Et,Gn=He.default.memo(({active:e,focus:t,rowData:n,setRowData:r,columnData:{placeholder:o,alignRight:i,formatInputOnFocus:l,formatBlurredInput:c,parseUserInput:p,continuousUpdates:s}})=>{const u=(0,He.useRef)(null),b=(0,pl.useFirstRender)(),f=(0,He.useRef)({rowData:n,formatInputOnFocus:l,formatBlurredInput:c,setRowData:r,parseUserInput:p,continuousUpdates:s,firstRender:b,focusedAt:0,changedAt:0,escPressed:!1});return f.current={rowData:n,formatInputOnFocus:l,formatBlurredInput:c,setRowData:r,parseUserInput:p,continuousUpdates:s,firstRender:b,focusedAt:f.current.focusedAt,changedAt:f.current.changedAt,escPressed:f.current.escPressed},(0,He.useLayoutEffect)(()=>{t?(u.current&&(u.current.value=f.current.formatInputOnFocus(f.current.rowData),u.current.focus(),u.current.select()),f.current.escPressed=!1,f.current.focusedAt=Date.now()):u.current&&(!f.current.escPressed&&!f.current.continuousUpdates&&!f.current.firstRender&&f.current.changedAt>=f.current.focusedAt&&f.current.setRowData(f.current.parseUserInput(u.current.value)),u.current.blur())},[t]),(0,He.useEffect)(()=>{!t&&u.current&&(u.current.value=f.current.formatBlurredInput(n))},[t,n]),He.default.createElement("input",{defaultValue:c(n),className:(0,vl.default)("dsg-input",i&&"dsg-input-align-right"),placeholder:e?o:void 0,tabIndex:-1,ref:u,style:{pointerEvents:t?"auto":"none"},onChange:C=>{f.current.changedAt=Date.now(),s&&r(p(C.target.value))},onKeyDown:C=>{C.key==="Escape"&&(f.current.escPressed=!0)}})});Gn.displayName="TextComponent";Te.textColumn=Kn();function Kn({placeholder:e,alignRight:t=!1,continuousUpdates:n=!0,deletedValue:r=null,parseUserInput:o=s=>s.trim()||null,formatBlurredInput:i=s=>String(s??""),formatInputOnFocus:l=s=>String(s??""),formatForCopy:c=s=>String(s??""),parsePastedValue:p=s=>s.replace(/[\n\r]+/g," ").trim()||null}={}){return{component:Gn,columnData:{placeholder:e,alignRight:t,continuousUpdates:n,formatInputOnFocus:l,formatBlurredInput:i,parseUserInput:o},deleteValue:()=>r,copyValue:({rowData:s})=>c(s),pasteValue:({value:s})=>p(s),isCellEmpty:({rowData:s})=>s==null}}Te.createTextColumn=Kn;var xt={},gl=x&&x.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),bl=x&&x.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),_l=x&&x.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&gl(t,e,n);return bl(t,e),t};Object.defineProperty(xt,"__esModule",{value:!0});xt.checkboxColumn=void 0;const ct=_l(B),yl=["","false","no","off","disabled","0","n","f","unchecked","undefined","null","wrong","negative"],kn=ct.default.memo(({focus:e,rowData:t,setRowData:n,active:r,stopEditing:o,disabled:i})=>{const l=(0,ct.useRef)(null);return(0,ct.useLayoutEffect)(()=>{e&&(n(!t),o({nextRow:!1}))},[e,o]),ct.default.createElement("input",{className:"dsg-checkbox",tabIndex:-1,type:"checkbox",ref:l,disabled:i,checked:!!t,onMouseDown:()=>!r&&n(!t),onChange:()=>null})});kn.displayName="CheckboxComponent";xt.checkboxColumn={component:kn,deleteValue:()=>!1,copyValue:({rowData:e})=>e?"YES":"NO",pasteValue:({value:e})=>!yl.includes(e.toLowerCase()),isCellEmpty:({rowData:e})=>!e};var Ct={};Object.defineProperty(Ct,"__esModule",{value:!0});Ct.floatColumn=void 0;const wl=Te;Ct.floatColumn=(0,wl.createTextColumn)({alignRight:!0,formatBlurredInput:e=>typeof e=="number"?new Intl.NumberFormat().format(e):"",parseUserInput:e=>{const t=parseFloat(e);return isNaN(t)?null:t},parsePastedValue:e=>{const t=parseFloat(e);return isNaN(t)?null:t}});var St={};Object.defineProperty(St,"__esModule",{value:!0});St.intColumn=void 0;const Ol=Te;St.intColumn=(0,Ol.createTextColumn)({alignRight:!0,formatBlurredInput:e=>typeof e=="number"?new Intl.NumberFormat().format(e):"",parseUserInput:e=>{const t=parseFloat(e);return isNaN(t)?null:Math.round(t)},parsePastedValue:e=>{const t=parseFloat(e);return isNaN(t)?null:Math.round(t)}});var Dt={};Object.defineProperty(Dt,"__esModule",{value:!0});Dt.percentColumn=void 0;const El=Te,xl=1e12,Cl=1e10;Dt.percentColumn=(0,El.createTextColumn)({alignRight:!0,formatBlurredInput:e=>typeof e=="number"?new Intl.NumberFormat(void 0,{style:"percent"}).format(e):"",formatInputOnFocus:e=>typeof e=="number"&&!isNaN(e)?String(Math.round(e*xl)/Cl):"",parseUserInput:e=>{const t=parseFloat(e);return isNaN(t)?null:t/100},parsePastedValue:e=>{const t=parseFloat(e);return isNaN(t)?null:t}});var Mt={},Sl=x&&x.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),Dl=x&&x.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Ml=x&&x.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&Sl(t,e,n);return Dl(t,e),t},Rl=x&&x.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Mt,"__esModule",{value:!0});Mt.dateColumn=void 0;const dt=Ml(B),jl=Rl(Qe),Un=dt.default.memo(({focus:e,active:t,rowData:n,setRowData:r})=>{var o;const i=(0,dt.useRef)(null);return(0,dt.useLayoutEffect)(()=>{var l,c;e?(l=i.current)===null||l===void 0||l.select():(c=i.current)===null||c===void 0||c.blur()},[e]),dt.default.createElement("input",{className:(0,jl.default)("dsg-input",!t&&"dsg-hide-date-picker"),type:"date",tabIndex:-1,max:"9999-12-31",ref:i,style:{pointerEvents:e?"auto":"none",opacity:n||t?void 0:0},value:(o=n==null?void 0:n.toISOString().substr(0,10))!==null&&o!==void 0?o:"",onChange:l=>{const c=new Date(l.target.value);r(isNaN(c.getTime())?null:c)}})});Un.displayName="DateComponent";Mt.dateColumn={component:Un,deleteValue:()=>null,copyValue:({rowData:e})=>e?e.toISOString().substr(0,10):null,pasteValue:({value:e})=>{const t=new Date(e.replace(/\.\s?|\//g,"-"));return isNaN(t.getTime())?null:t},minWidth:170,isCellEmpty:({rowData:e})=>!e};var Rt={},Il=x&&x.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),Tl=x&&x.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Pl=x&&x.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&Il(t,e,n);return Tl(t,e),t},zl=x&&x.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Rt,"__esModule",{value:!0});Rt.isoDateColumn=void 0;const ft=Pl(B),Nl=zl(Qe),qn=ft.default.memo(({focus:e,active:t,rowData:n,setRowData:r})=>{const o=(0,ft.useRef)(null);return(0,ft.useLayoutEffect)(()=>{var i,l;e?(i=o.current)===null||i===void 0||i.select():(l=o.current)===null||l===void 0||l.blur()},[e]),ft.default.createElement("input",{className:(0,Nl.default)("dsg-input",!t&&"dsg-hide-date-picker"),type:"date",tabIndex:-1,max:"9999-12-31",ref:o,style:{pointerEvents:e?"auto":"none",opacity:n||t?void 0:0},value:n??"",onChange:i=>{const l=new Date(i.target.value);r(isNaN(l.getTime())?null:l.toISOString().substr(0,10))}})});qn.displayName="IsoDateComponent";Rt.isoDateColumn={component:qn,deleteValue:()=>null,pasteValue:({value:e})=>{const t=new Date(e.replace(/\.\s?|\//g,"-"));return isNaN(t.getTime())?null:t.toISOString().substr(0,10)},minWidth:170,isCellEmpty:({rowData:e})=>!e};var jt={},Al=x&&x.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),$l=x&&x.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Fl=x&&x.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&Al(t,e,n);return $l(t,e),t},Wl=x&&x.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n};Object.defineProperty(jt,"__esModule",{value:!0});jt.keyColumn=void 0;const tt=Fl(B),Bl=e=>{var{columnData:{key:t,original:n},rowData:r,setRowData:o}=e,i=Wl(e,["columnData","rowData","setRowData"]);const l=(0,tt.useRef)(r);l.current=r;const c=(0,tt.useCallback)(s=>{o(Object.assign(Object.assign({},l.current),{[t]:s}))},[t,o]);if(!n.component)return tt.default.createElement(tt.default.Fragment,null);const p=n.component;return tt.default.createElement(p,Object.assign({columnData:n.columnData,setRowData:c,rowData:r[t]},i))},Ll=(e,t)=>Object.assign(Object.assign({id:e},t),{columnData:{key:e,original:t},component:Bl,copyValue:({rowData:n,rowIndex:r})=>{var o,i;return(i=(o=t.copyValue)===null||o===void 0?void 0:o.call(t,{rowData:n[e],rowIndex:r}))!==null&&i!==void 0?i:null},deleteValue:({rowData:n,rowIndex:r})=>{var o,i;return Object.assign(Object.assign({},n),{[e]:(i=(o=t.deleteValue)===null||o===void 0?void 0:o.call(t,{rowData:n[e],rowIndex:r}))!==null&&i!==void 0?i:null})},pasteValue:({rowData:n,value:r,rowIndex:o})=>{var i,l;return Object.assign(Object.assign({},n),{[e]:(l=(i=t.pasteValue)===null||i===void 0?void 0:i.call(t,{rowData:n[e],value:r,rowIndex:o}))!==null&&l!==void 0?l:null})},disabled:typeof t.disabled=="function"?({rowData:n,rowIndex:r})=>{var o;return typeof t.disabled=="function"?t.disabled({rowData:n[e],rowIndex:r}):(o=t.disabled)!==null&&o!==void 0?o:!1}:t.disabled,cellClassName:typeof t.cellClassName=="function"?({rowData:n,rowIndex:r,columnId:o})=>{var i;return typeof t.cellClassName=="function"?t.cellClassName({rowData:n[e],rowIndex:r,columnId:o}):(i=t.cellClassName)!==null&&i!==void 0?i:void 0}:t.cellClassName,isCellEmpty:({rowData:n,rowIndex:r})=>{var o,i;return(i=(o=t.isCellEmpty)===null||o===void 0?void 0:o.call(t,{rowData:n[e],rowIndex:r}))!==null&&i!==void 0?i:!1}});jt.keyColumn=Ll;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.renderContextMenuItem=e.createContextMenuComponent=e.createAddRowsComponent=e.keyColumn=e.isoDateColumn=e.dateColumn=e.percentColumn=e.intColumn=e.floatColumn=e.checkboxColumn=e.createTextColumn=e.textColumn=e.DataSheetGrid=e.DynamicDataSheetGrid=void 0;const t=Xt,n=Ot;e.DynamicDataSheetGrid=t.DataSheetGrid,e.DataSheetGrid=n.StaticDataSheetGrid;var r=Te;Object.defineProperty(e,"textColumn",{enumerable:!0,get:function(){return r.textColumn}}),Object.defineProperty(e,"createTextColumn",{enumerable:!0,get:function(){return r.createTextColumn}});var o=xt;Object.defineProperty(e,"checkboxColumn",{enumerable:!0,get:function(){return o.checkboxColumn}});var i=Ct;Object.defineProperty(e,"floatColumn",{enumerable:!0,get:function(){return i.floatColumn}});var l=St;Object.defineProperty(e,"intColumn",{enumerable:!0,get:function(){return l.intColumn}});var c=Dt;Object.defineProperty(e,"percentColumn",{enumerable:!0,get:function(){return c.percentColumn}});var p=Mt;Object.defineProperty(e,"dateColumn",{enumerable:!0,get:function(){return p.dateColumn}});var s=Rt;Object.defineProperty(e,"isoDateColumn",{enumerable:!0,get:function(){return s.isoDateColumn}});var u=jt;Object.defineProperty(e,"keyColumn",{enumerable:!0,get:function(){return u.keyColumn}});var b=Qt;Object.defineProperty(e,"createAddRowsComponent",{enumerable:!0,get:function(){return b.createAddRowsComponent}});var f=Jt;Object.defineProperty(e,"createContextMenuComponent",{enumerable:!0,get:function(){return f.createContextMenuComponent}}),Object.defineProperty(e,"renderContextMenuItem",{enumerable:!0,get:function(){return f.defaultRenderItem}})})(Ce);function Gl(){const[e,t]=B.useState([{"":!1,firstName:"Elon",lastName:"Musk",quantity:1},{"":!1,firstName:"Jeff",lastName:"Bezos",quantity:2},{"":!1,firstName:"Test",lastName:"Bezos",quantity:1}]),[n,r]=B.useState(0),o=!!n;console.log(o);const i=[{...Ce.keyColumn("",Ce.checkboxColumn),title:"",maxWidth:50},{...Ce.keyColumn("firstName",Ce.textColumn),title:"First name"},{...Ce.keyColumn("lastName",Ce.textColumn),title:"Last name"},{...Ce.keyColumn("quantity",Ce.floatColumn),title:"Quantity"}];return console.log(n),Lt.jsxs("div",{className:"flex flex-col mt-12",children:[o&&Lt.jsxs("p",{className:"text-right",children:["Sum Quantity: ",n]}),Lt.jsx(Ce.DataSheetGrid,{value:e,onChange:t,columns:i,onActiveCellChange:l=>{console.log(l),(!l.cell||l.cell.colId!=="quantity")&&r(0)},onSelectionChange:({selection:l})=>{if(!l||l.max.row===l.min.row)return;console.log("---take a look---"),console.log(l);const c=l.max.col,p=l.min.col;if(c!==p)return;const s=e.slice(l==null?void 0:l.min.row,((l==null?void 0:l.max.row)||1)+1),u=Object.keys(s[0])[l.max.col];if(u!=="quantity")return;console.log("hi---"),console.log(u);const b=s.reduce((f,C)=>(C.quantity||1)+f,0);r(b)}})]})}export{Gl as default};
